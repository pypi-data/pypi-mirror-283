import{d as U,r as S,H as Z,t as g,L as A,A as v,z as u,aD as d,aU as k,V as q,aT as K,M as G,c as R,o as J,v as E,X as T,B as $,y as D,x as Y,Q as O,aW as ee,S as te,ae as P,aE as ne,T as re,R as ae}from"./D3CI8m9t.js";import{u as H}from"./BsX8Qw9W.js";import{u as Q,V as I,f as le,a as oe}from"./Cb9vhoRm.js";import{V as ie}from"./DwaXqGRd.js";import{V as se,D as ue}from"./D6wGJThG.js";import"./DlAUqK2U.js";import"./n17uZUSv.js";import"./WVDAUELO.js";function N(e){"@babel/helpers - typeof";return N=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(e)}function j(e){var t=typeof e=="string"||e instanceof String;if(!t){var n=N(e);throw e===null?n="null":n==="object"&&(n=e.constructor.name),new TypeError("Expected a string but received a ".concat(n))}}function W(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;for(var n in t)typeof e[n]>"u"&&(e[n]=t[n]);return e}var ce={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_numeric_tld:!1,allow_wildcard:!1,ignore_max_length:!1};function fe(e,t){j(e),t=W(t,ce),t.allow_trailing_dot&&e[e.length-1]==="."&&(e=e.substring(0,e.length-1)),t.allow_wildcard===!0&&e.indexOf("*.")===0&&(e=e.substring(2));var n=e.split("."),l=n[n.length-1];return t.require_tld&&(n.length<2||!t.allow_numeric_tld&&!/^([a-z\u00A1-\u00A8\u00AA-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}|xn[a-z0-9-]{2,})$/i.test(l)||/\s/.test(l))||!t.allow_numeric_tld&&/^\d+$/.test(l)?!1:n.every(function(r){return!(r.length>63&&!t.ignore_max_length||!/^[a-z_\u00a1-\uffff0-9-]+$/i.test(r)||/[\uff01-\uff5e]/.test(r)||/^-|-$/.test(r)||!t.allow_underscores&&/_/.test(r))})}var M="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",b="(".concat(M,"[.]){3}").concat(M),de=new RegExp("^".concat(b,"$")),s="(?:[0-9a-fA-F]{1,4})",me=new RegExp("^("+"(?:".concat(s,":){7}(?:").concat(s,"|:)|")+"(?:".concat(s,":){6}(?:").concat(b,"|:").concat(s,"|:)|")+"(?:".concat(s,":){5}(?::").concat(b,"|(:").concat(s,"){1,2}|:)|")+"(?:".concat(s,":){4}(?:(:").concat(s,"){0,1}:").concat(b,"|(:").concat(s,"){1,3}|:)|")+"(?:".concat(s,":){3}(?:(:").concat(s,"){0,2}:").concat(b,"|(:").concat(s,"){1,4}|:)|")+"(?:".concat(s,":){2}(?:(:").concat(s,"){0,3}:").concat(b,"|(:").concat(s,"){1,5}|:)|")+"(?:".concat(s,":){1}(?:(:").concat(s,"){0,4}:").concat(b,"|(:").concat(s,"){1,6}|:)|")+"(?::((?::".concat(s,"){0,5}:").concat(b,"|(?::").concat(s,"){1,7}|:))")+")(%[0-9a-zA-Z-.:]{1,})?$");function C(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return j(e),t=String(t),t?t==="4"?de.test(e):t==="6"?me.test(e):!1:C(e,4)||C(e,6)}function pe(e,t){return ge(e)||ye(e,t)||_e(e,t)||ve()}function ve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _e(e,t){if(e){if(typeof e=="string")return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}}function B(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,l=new Array(t);n<t;n++)l[n]=e[n];return l}function ye(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var l,r,c,o,m=[],a=!0,i=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(a=(l=c.call(n)).done)&&(m.push(l.value),m.length!==t);a=!0);}catch(y){i=!0,r=y}finally{try{if(!a&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(i)throw r}}return m}}function ge(e){if(Array.isArray(e))return e}var he={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_host:!0,require_port:!1,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1,allow_fragments:!0,allow_query_components:!0,validate_length:!0},be=/^\[([^\]]+)\](?::([0-9]+))?$/;function Se(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function z(e,t){for(var n=0;n<t.length;n++){var l=t[n];if(e===l||Se(l)&&l.test(e))return!0}return!1}function we(e,t){if(j(e),!e||/[\s<>]/.test(e)||e.indexOf("mailto:")===0||(t=W(t,he),t.validate_length&&e.length>=2083)||!t.allow_fragments&&e.includes("#")||!t.allow_query_components&&(e.includes("?")||e.includes("&")))return!1;var n,l,r,c,o,m,a,i;if(a=e.split("#"),e=a.shift(),a=e.split("?"),e=a.shift(),a=e.split("://"),a.length>1){if(n=a.shift().toLowerCase(),t.require_valid_protocol&&t.protocols.indexOf(n)===-1)return!1}else{if(t.require_protocol)return!1;if(e.slice(0,2)==="//"){if(!t.allow_protocol_relative_urls)return!1;a[0]=e.slice(2)}}if(e=a.join("://"),e==="")return!1;if(a=e.split("/"),e=a.shift(),e===""&&!t.require_host)return!0;if(a=e.split("@"),a.length>1){if(t.disallow_auth||a[0]===""||(l=a.shift(),l.indexOf(":")>=0&&l.split(":").length>2))return!1;var y=l.split(":"),w=pe(y,2),x=w[0],V=w[1];if(x===""&&V==="")return!1}c=a.join("@"),m=null,i=null;var p=c.match(be);if(p?(r="",i=p[1],m=p[2]||null):(a=c.split(":"),r=a.shift(),a.length&&(m=a.join(":"))),m!==null&&m.length>0){if(o=parseInt(m,10),!/^[0-9]+$/.test(m)||o<=0||o>65535)return!1}else if(t.require_port)return!1;return t.host_whitelist?z(r,t.host_whitelist):r===""&&!t.require_host?!0:!(!C(r)&&!fe(r,t)&&(!i||!C(i,6))||(r=r||i,t.host_blacklist&&z(r,t.host_blacklist)))}const X=U({__name:"ScannerForm",props:{scanner:{type:Object,default:()=>({endpoint:"",apiKey:"",name:""})},isEditMode:{type:Boolean,defualt:!1}},emits:["close-form"],setup(e,{emit:t}){const n={endpoint:"",apiKey:"",name:""},l=e,r=S(),c=S(!1),o=t,m=H(),a=Q(),i=S(n),y={required:p=>p.trim()!==""||"",url:p=>we(p)||"Must be a valid URL"};Z(l.scanner,p=>{i.value={...p}},{immediate:!0,deep:!0});const w=async()=>{if(c.value===!0&&i.value!==null)try{m.addOrUpdateScanner(i.value),x(),o("close-form"),a.reportSuccess("Scanner saved successfully.")}catch{a.reportError("Failed to save scanner information. Please try again.")}},x=()=>{i.value=n},V=()=>{x(),o("close-form")};return(p,f)=>(g(),A(ie,{ref_key:"form",ref:r,modelValue:d(c),"onUpdate:modelValue":f[3]||(f[3]=_=>K(c)?c.value=_:null),onSubmit:G(w,["prevent"])},{default:v(()=>[u(k,{modelValue:d(i).endpoint,"onUpdate:modelValue":f[0]||(f[0]=_=>d(i).endpoint=_),variant:"outlined",density:"compact",label:"Scanner Endpoint",placeholder:"https://api.example.com/graphql",disabled:e.isEditMode===!0,rules:[y.required,y.url]},null,8,["modelValue","disabled","rules"]),u(k,{modelValue:d(i).name,"onUpdate:modelValue":f[1]||(f[1]=_=>d(i).name=_),variant:"outlined",density:"compact",label:"Scanner Name",placeholder:"Scanner Name",rules:[y.required]},null,8,["modelValue","rules"]),u(k,{modelValue:d(i).apiKey,"onUpdate:modelValue":f[2]||(f[2]=_=>d(i).apiKey=_),variant:"outlined",density:"compact",label:"API Key",placeholder:"Enter API Key",rules:[y.required]},null,8,["modelValue","rules"]),u(q,{class:"me-2",type:"submit",color:"success",text:"Save","prepend-icon":"mdi-check",disabled:!d(c)},null,8,["disabled"]),u(q,{text:"Cancel","prepend-icon":"mdi-close",onClick:V})]),_:1},8,["modelValue"]))}}),xe=U({__name:"ScannersList",setup(e){const t=H(),n=Q(),l=S(!0),r=S(!1),c=S(!1),o=S(null),m=[{title:"Name",value:"name",align:"left",width:"10%"},{title:"Endpoint",value:"endpoint",align:"left"},{title:"Actions",value:"actions",align:"center",width:"5%"}],a=[{title:"Edit",action:f=>w(f),icon:"mdi-pencil-outline",color:"primary",divider:!0},{title:"Delete",action:f=>V(f),icon:"mdi-delete",color:"red"}],i=R(()=>t.scanners),y=R(()=>o.value===null?"Are you sure you would like to delete this scanner?":`Are you sure you would like to delete the '${o.value.name}' scanner?`),w=f=>{o.value=f,c.value=!0},x=()=>{c.value=!1,o.value=null},V=f=>{o.value=f,r.value=!0},p=()=>{if(o.value!==null)try{t.deleteScanner(o.value.endpoint),n.reportSuccess("Scanner deleted successfully.")}catch{n.reportError("Failed to delete scanner. Please try again.")}finally{o.value=null}};return J(()=>{l.value=!1}),(f,_)=>(g(),E("div",null,[u(d(ue),{"model-value":d(r),"onUpdate:modelValue":_[0]||(_[0]=h=>K(r)?r.value=h:null),title:d(y),"cancel-button-text":"Cancel","confirm-button-text":"Delete","cancel-icon":"mdi-close","confirm-icon":"mdi-check","confirm-button-color":"secondary","card-icon":"mdi-trash-can-outline",onConfirm:p,onCancel:_[1]||(_[1]=h=>o.value=null)},null,8,["model-value","title"]),d(c)===!0?(g(),A(I,{key:0,variant:"outlined",class:"pa-4 mb-4"},{default:v(()=>[u(X,{scanner:d(o),"is-edit-mode":!0,onCloseForm:x},null,8,["scanner"])]),_:1})):T("",!0),u(I,{variant:"outlined"},{default:v(()=>[u(se,{loading:d(l),headers:m,items:d(i),"items-per-page":-1,"hide-default-footer":"","loading-text":"Loading scanners...","no-data-text":"No scanners added",density:"compact"},{"item.name":v(({item:h})=>[$(D(h.name),1)]),"item.endpoint":v(({item:h})=>[Y("code",null,D(h.endpoint),1)]),"item.actions":v(({item:h})=>[u(q,{variant:"flat"},{default:v(()=>[u(O,{icon:"mdi-dots-vertical"}),u(ee,{activator:"parent",location:"bottom"},{default:v(()=>[u(te,{density:"compact",class:"py-0"},{default:v(()=>[(g(),E(P,null,ne(a,(F,L)=>(g(),E(P,{key:`item-${F.title}-${L}`},[u(re,{onClick:Ve=>F.action(h)},{default:v(()=>[u(O,{start:"",size:"small",icon:F.icon},null,8,["icon"]),$(" "+D(F.title),1)]),_:2},1032,["onClick"]),L!==a.length-1?(g(),A(ae,{key:0})):T("",!0)],64))),64))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["loading","items"])]),_:1})]))}}),Ie=U({__name:"index",setup(e){const t=S(!1),n=[{text:"Scanners",disabled:!0,to:"/scanners",exact:!0}];return(l,r)=>(g(),E("div",null,[u(d(oe),{breadcrumbs:n,class:"mb-5"}),u(I,{variant:"outlined",class:"my-4"},{default:v(()=>[u(le,null,{default:v(()=>[d(t)===!1?(g(),A(q,{key:0,color:"accent","prepend-icon":"mdi-plus",onClick:r[0]||(r[0]=c=>t.value=!d(t))},{default:v(()=>[$(" New ")]),_:1})):(g(),A(X,{key:1,onCloseForm:r[1]||(r[1]=c=>t.value=!1)}))]),_:1})]),_:1}),u(xe)]))}});export{Ie as default};
