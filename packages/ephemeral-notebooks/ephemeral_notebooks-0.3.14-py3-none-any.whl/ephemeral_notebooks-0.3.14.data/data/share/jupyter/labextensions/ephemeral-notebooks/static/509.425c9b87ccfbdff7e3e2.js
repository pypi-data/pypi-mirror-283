"use strict";(self.webpackChunkephemeral_notebooks=self.webpackChunkephemeral_notebooks||[]).push([[509],{509:(e,t,o)=>{o.r(t),o.d(t,{default:()=>u});var n=o(212),a=o(751),c=o(262),l=o(902),s=o(110),i=o(811),r=o(256);console.log("in outside new");let d=null;class p extends r.Widget{constructor(e,t){super(),this.onSave=e,this.initialSettings=t,this.buildDialog()}buildDialog(){const e=document.createElement("div");e.style.padding="15px";const t=document.createElement("h2");t.textContent="Settings",e.appendChild(t);const o=document.createElement("label");o.style.display="block",o.style.marginBottom="10px";const n=document.createElement("input");n.type="checkbox",n.checked=this.initialSettings.copyOutput,o.appendChild(n),o.appendChild(document.createTextNode(" Copy notebook output")),e.appendChild(o);const a=document.createElement("label");a.style.display="block",a.style.marginBottom="10px",a.textContent="URL path: ";const c=document.createElement("select");["/lab/index.html","/retro/notebooks/index.html","/tree/index.html"].forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e,e===this.initialSettings.urlPath&&(t.selected=!0),c.appendChild(t)})),a.appendChild(c),e.appendChild(a);const l=document.createElement("button");l.textContent="Save",l.onclick=()=>{this.onSave({copyOutput:n.checked,urlPath:c.value})},e.appendChild(l),this.node.appendChild(e)}}const u={id:"urlify-nb",autoStart:!0,requires:[i.IFileBrowserFactory,a.IRouter,l.INotebookTracker],activate:async(e,t,o,a)=>{try{console.log("Activating ephemeral-notebooks extension: new"),o.register({command:"notebook:start-nav",pattern:/(tempNotebook=1)/,rank:20}),function(e,t){let o={copyOutput:!1,urlPath:"/lab/index.html"};const a=new s.ToolbarButton({label:"Save to url",onClick:()=>{const e=t.currentWidget;console.log("in press",e,o),e&&async function(e,t){let o=e.context.model.toJSON();if(t.copyOutput||(o.cells=o.cells.map((e=>("code"===e.cell_type&&(e.outputs=[],e.execution_count=null),e)))),JSON.stringify(o).length>1e4){const e=await(0,s.showDialog)({title:"Large Notebook",body:"The notebook content exceeds 10,000 characters. Do you want to continue with the full content or copy only inputs?",buttons:[s.Dialog.cancelButton(),s.Dialog.okButton({label:"Full Content"}),s.Dialog.okButton({label:"Inputs Only"})]});if("Inputs Only"===e.button.label)o.cells=o.cells.map((e=>("code"===e.cell_type&&(e.outputs=[],e.execution_count=null),e)));else if(!1===e.button.accept)return}const a=n.compressToEncodedURIComponent(JSON.stringify(o)),c=new URL(window.location.href);c.pathname=t.urlPath,c.hash=`notebook=${a}`,c.searchParams.set("tempNotebook","1"),c.searchParams.set("path","temp.ipynb"),console.log("new url",c.toString());const l=c.toString();s.Clipboard.copyToSystem(l)}(e,o)},tooltip:"Save notebook content to URL and copy to clipboard"}),c=new s.ToolbarButton({icon:"ui-components:settings",onClick:()=>{const e=new p((t=>{o=t,e.dispose()}),o);(0,s.showDialog)({title:"Save to URL Settings",body:e,buttons:[s.Dialog.cancelButton()]})},tooltip:"Save to URL Settings"});t.widgetAdded.connect(((e,t)=>{const o=document.createElement("div");o.appendChild(a.node),o.appendChild(c.node),console.log("container",o,t.toolbar),t.toolbar.insertItem(10,"saveToUrl",o)}))}(0,a),function(){const e=new URLSearchParams(window.location.hash.slice(1));d=e,console.log("Saved URL parameters:",d.toString())}(),await function(e,t,o){o&&(e.commands.addCommand("notebook:start-nav",{label:"Open Temp Notebook from URL",execute:async t=>{const{request:n}=t,a=new URL(`http://example.com${n}`).searchParams.get("tempNotebook"),c=async()=>{o.routed.disconnect(c),a&&"1"==a&&await e.commands.execute("notebook:open-temp",{})};o.routed.connect(c)}}),e.commands.addCommand("notebook:open-temp",{label:"Open Temporary Notebook",execute:async o=>{var a,l;const s=null!==(a=null==t?void 0:t.tracker.currentWidget)&&void 0!==a?a:t.defaultBrowser,i=o.cwd||(null!==(l=null==s?void 0:s.model.path)&&void 0!==l?l:""),r=o.kernelId||"",p=o.kernelName||"";await(async(t,o,a)=>{const l=await e.commands.execute("docmanager:new-untitled",{path:t,type:"notebook"});if(void 0!==l){const t=await e.commands.execute("docmanager:open",{path:l.path,factory:"Notebook",kernel:{id:o,name:a}});t.isUntitled=!0;const s=`temp-notebook-${c.UUID.uuid4()}`;await t.context.rename(s+".ipynb");const i=function(){if(d){const e=d.get("notebook");if(e){const t=n.decompressFromEncodedURIComponent(e),o=JSON.parse(t);return console.log("decompressedContent",o),o}}return null}();return i&&(t.context.model.fromJSON(i),await t.context.save()),t}})(i,r,p)}}))}(e,t,o),console.log("ephemeral-notebooks extension activated successfully")}catch(e){console.error("Error activating ephemeral-notebooks extension:",e)}}}}}]);