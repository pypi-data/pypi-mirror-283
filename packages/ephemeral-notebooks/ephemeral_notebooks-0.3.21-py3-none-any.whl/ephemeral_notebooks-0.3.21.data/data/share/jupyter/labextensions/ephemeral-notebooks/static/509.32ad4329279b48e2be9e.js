"use strict";(self.webpackChunkephemeral_notebooks=self.webpackChunkephemeral_notebooks||[]).push([[509],{509:(t,e,o)=>{o.r(e),o.d(e,{default:()=>m});var n=o(212),l=o(751),a=o(262),s=o(902),i=o(110),c=o(811),r=o(256),d=o(858);console.log("in outside new");let p=null;class u extends r.Widget{constructor(t,e){super(),this.onSettingsChange=t,this.initialSettings=e,this.buildDialog()}buildDialog(){const t=document.createElement("div");t.style.padding="15px";const e=this.createSwitchControl("Copy notebook output",this.initialSettings.copyOutput,(t=>this.updateSettings({copyOutput:t})));t.appendChild(e);const o=this.createSwitchControl("Open as notebook",this.initialSettings.openAsNotebook,(t=>this.updateSettings({openAsNotebook:t})));t.appendChild(o);const n=document.createElement("label");n.style.display="block",n.style.marginBottom="10px",n.textContent="URL path: ";const l=document.createElement("select");l.style.width="100%",l.style.marginBottom="10px";const a=window.location.href.split("/lab")[0];[{label:"JupyterLite",value:"/jupyterlite/lab/index.html"},{label:"JupyterLab",value:"/lab/index.html"},{label:"Custom",value:"custom"}].forEach((t=>{const e=document.createElement("option");e.value=t.value,e.textContent=`${t.label}${"custom"!==t.value?` (${a}${t.value})`:""}`,t.value===this.initialSettings.urlPath&&(e.selected=!0),l.appendChild(e)})),n.appendChild(l),t.appendChild(n);const s=document.createElement("input");s.type="text",s.placeholder="Enter custom URL path",s.style.width="100%",s.style.marginBottom="10px",s.style.display="none",t.appendChild(s);const i=document.createElement("p");i.textContent="Reminder: urlify must be installed on the Jupyter instance for custom URLs.",i.style.color="orange",i.style.display="none",t.appendChild(i),l.addEventListener("change",(()=>{"custom"===l.value?(s.style.display="block",i.style.display="block"):(s.style.display="none",i.style.display="none",this.updateSettings({urlPath:l.value}))})),s.addEventListener("input",(()=>{this.updateSettings({urlPath:s.value})})),this.node.appendChild(t)}createSwitchControl(t,e,o){const n=document.createElement("label");n.style.display="flex",n.style.alignItems="center",n.style.marginBottom="10px",n.style.cursor="pointer";const l=document.createElement("div");l.style.width="40px",l.style.height="20px",l.style.backgroundColor=e?"#4CAF50":"#ccc",l.style.borderRadius="10px",l.style.position="relative",l.style.transition="background-color 0.3s",l.style.marginRight="10px";const a=document.createElement("div");return a.style.width="18px",a.style.height="18px",a.style.backgroundColor="white",a.style.borderRadius="50%",a.style.position="absolute",a.style.top="1px",a.style.left=e?"21px":"1px",a.style.transition="left 0.3s",l.appendChild(a),n.appendChild(l),n.appendChild(document.createTextNode(t)),n.addEventListener("click",(()=>{const t="1px"===a.style.left;a.style.left=t?"21px":"1px",l.style.backgroundColor=t?"#4CAF50":"#ccc",o(t)})),n}updateSettings(t){this.onSettingsChange({...this.initialSettings,...t})}}const m={id:"urlify-nb",autoStart:!0,requires:[c.IFileBrowserFactory,l.IRouter,s.INotebookTracker],activate:async(t,e,o,l)=>{try{console.log("Activating ephemeral-notebooks extension: new"),o.register({command:"notebook:start-nav",pattern:/(tempNotebook=1)/,rank:20}),function(t,e){let o={copyOutput:!1,openAsNotebook:!0,urlPath:"/lab/index.html"};const l=new i.ToolbarButton({label:"Save to url",onClick:()=>{const t=e.currentWidget;console.log("in press",t,o),t&&async function(t,e){let o=t.context.model.toJSON();if(e.copyOutput||(o.cells=o.cells.map((t=>("code"===t.cell_type&&(t.outputs=[],t.execution_count=null),t)))),JSON.stringify(o).length>1e4){const t=await(0,i.showDialog)({title:"Large Notebook",body:"The notebook content exceeds 10,000 characters. Do you want to continue with the full content or copy only inputs?",buttons:[i.Dialog.cancelButton(),i.Dialog.okButton({label:"Full Content"}),i.Dialog.okButton({label:"Inputs Only"})]});if("Inputs Only"===t.button.label)o.cells=o.cells.map((t=>("code"===t.cell_type&&(t.outputs=[],t.execution_count=null),t)));else if(!1===t.button.accept)return}const l=n.compressToEncodedURIComponent(JSON.stringify(o)),a=new URL(window.location.href);a.pathname=e.urlPath,a.hash=`notebook=${l}`,a.searchParams.set("tempNotebook","1"),a.searchParams.set("path","temp.ipynb"),console.log("new url",a.toString());const s=a.toString();i.Clipboard.copyToSystem(s)}(t,o)},tooltip:"Save notebook content to URL and copy to clipboard"}),a=new i.ToolbarButton({icon:d.settingsIcon,onClick:()=>{const t=new u((e=>{o=e,t.dispose()}),o);(0,i.showDialog)({title:"Save to URL Settings",body:t,buttons:[i.Dialog.cancelButton()]})},tooltip:"Save to URL Settings"});e.widgetAdded.connect(((t,e)=>{console.log("added",l,a,e.toolbar),e.toolbar.insertItem(10,"saveToUrl",l),e.toolbar.insertItem(11,"settingsButton",a)}))}(0,l),function(){const t=new URLSearchParams(window.location.hash.slice(1));p=t,console.log("Saved URL parameters:",p.toString())}(),await function(t,e,o){o&&(t.commands.addCommand("notebook:start-nav",{label:"Open Temp Notebook from URL",execute:async e=>{const{request:n}=e,l=new URL(`http://example.com${n}`).searchParams.get("tempNotebook"),a=async()=>{o.routed.disconnect(a),l&&"1"==l&&await t.commands.execute("notebook:open-temp",{})};o.routed.connect(a)}}),t.commands.addCommand("notebook:open-temp",{label:"Open Temporary Notebook",execute:async o=>{var l,s;const i=null!==(l=null==e?void 0:e.tracker.currentWidget)&&void 0!==l?l:e.defaultBrowser,c=o.cwd||(null!==(s=null==i?void 0:i.model.path)&&void 0!==s?s:""),r=o.kernelId||"",d=o.kernelName||"";await(async(e,o,l)=>{const s=await t.commands.execute("docmanager:new-untitled",{path:e,type:"notebook"});if(void 0!==s){const i=await t.commands.execute("docmanager:open",{path:s.path,factory:"Notebook",kernel:{id:o,name:l}});i.isUntitled=!0;const c=`temp-notebook-${a.UUID.uuid4()}`;await i.context.rename(c+".ipynb");const r=function(){if(p){const t=p.get("notebook");if(t){const e=n.decompressFromEncodedURIComponent(t),o=JSON.parse(e);return console.log("decompressedContent",o),o}}return null}();function d(t){const e=new URL(window.location.href),o=window.location.href.match(/(.*\/)lab\/index\.html/);let n=(o?o[1]:"")+`notebooks/index.html?path=${t}&${t}&${e.search}&${e.hash}`;window.location.href=n}return r&&(i.context.model.fromJSON(r),await i.context.save()),d(i.context.path),i}})(c,r,d)}}))}(t,e,o),console.log("ephemeral-notebooks extension activated successfully")}catch(t){console.error("Error activating ephemeral-notebooks extension:",t)}}}}}]);