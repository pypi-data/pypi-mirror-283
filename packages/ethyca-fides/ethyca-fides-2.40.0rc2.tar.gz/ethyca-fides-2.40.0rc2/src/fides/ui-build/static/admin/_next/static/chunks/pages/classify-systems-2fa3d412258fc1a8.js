(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[738],{43212:function(e,t,s){"use strict";s.d(t,{Gn:function(){return a},zR:function(){return r}});var n=s(28841),i=s(24246),r=function(e){var t=e.title,s=e.onDelete;return(0,i.jsxs)(n.OXI,{py:2,display:"flex",alignItems:"center",children:[(0,i.jsx)(n.xvT,{mr:"2",children:t}),s?(0,i.jsx)(n.hU,{"aria-label":"delete",icon:(0,i.jsx)(n.lr0,{}),size:"xs",onClick:s,"data-testid":"delete-btn"}):null]})},a=function(e){var t=e.onClose,s=e.formId,r=e.isSaving;return(0,i.jsxs)(n.zeN,{justifyContent:"flex-start",children:[(0,i.jsx)(n.zxk,{onClick:t,mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,i.jsx)(n.zxk,{type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",form:s,isLoading:r,children:"Save"})]})};t.ZP=function(e){var t=e.header,s=e.description,r=e.isOpen,a=e.onClose,o=e.children,c=e.footer;return(0,i.jsxs)(n.dys,{placement:"right",isOpen:r,onClose:a,size:"lg",children:[(0,i.jsx)(n.P1B,{}),(0,i.jsxs)(n.scA,{"data-testid":"edit-drawer-content",py:2,children:[(0,i.jsx)(n.xuv,{display:"flex",justifyContent:"flex-end",mr:2,children:(0,i.jsx)(n.zxk,{variant:"ghost",onClick:a,"data-testid":"close-drawer-btn",children:(0,i.jsx)(n.LGN,{width:"17px"})})}),t,(0,i.jsxs)(n.Ng0,{children:[s?(0,i.jsx)(n.xvT,{fontSize:"sm",mb:4,children:s}):null,o]}),c]})]})}},48187:function(e,t,s){"use strict";s.d(t,{w:function(){return l}});var n=s(90849),i=s(27378),r=s(44047),a=s(4938);function o(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?o(Object(s),!0).forEach((function(t){(0,n.Z)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var l=function(e){var t=e.resourceType,s=e.fidesKeys,n=e.skip,o=(0,i.useState)(!0),l=o[0],d=o[1],u=(0,r.Wm)({resource_type:t,fides_keys:s},{skip:n,pollingInterval:l?3e3:void 0}),f=!!u.data&&u.data.every((function(e){return e.status===a.Wg.COMPLETE||e.status===a.Wg.FAILED||e.status===a.Wg.REVIEWED}));return(0,i.useEffect)((function(){f&&d(!1)}),[f]),c(c({},u),{},{isClassificationFinished:f})}},72779:function(e,t,s){"use strict";var n=s(90089),i=s(90849),r=s(28841),a=s(4938),o=s(24246),c=["status","resource"];function l(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(Object(s),!0).forEach((function(t){(0,i.Z)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}t.Z=function(e){var t=e.status,s=e.resource,l=(0,n.Z)(e,c),u=function(e){var t,s=e===a.j.DATASETS?"dataset":"system";return t={},(0,i.Z)(t,a.Wg.PROCESSING,{title:"Processing",tooltip:"This ".concat(s," is currently being ").concat("dataset"===s?"generated and":""," classified. You will be notified when this process is complete"),color:"orange"}),(0,i.Z)(t,a.Wg.CREATED,{title:"Processing",tooltip:"This ".concat(s," is currently being ").concat("dataset"===s&&"generated and"," and classified. You will be notified when this process is complete"),color:"orange"}),(0,i.Z)(t,a.Wg.COMPLETE,{title:"Awaiting Review",tooltip:"This ".concat(s," has been automatically classified. Review the results and update the ").concat(s,"."),color:"orange"}),(0,i.Z)(t,a.Wg.REVIEWED,{title:"Classified",tooltip:"This ".concat(s," has been classified."),color:"green"}),(0,i.Z)(t,a.Wg.FAILED,{title:"Failed",tooltip:"This ".concat(s," must be manually updated."),color:"red"}),(0,i.Z)(t,"unknown",{title:"Unknown",tooltip:"This ".concat(s," must be manually updated."),color:"gray"}),t}(s)[null!==t&&void 0!==t?t:"unknown"];return(0,o.jsx)(r.ua7,{"data-testid":"classification-status-badge",label:u.tooltip,children:(0,o.jsx)(r.Cts,d(d({variant:"solid",colorScheme:u.color,w:"100%",textAlign:"center"},l),{},{"data-testid":"classification-status-badge",children:u.title}))})}},52562:function(e,t,s){"use strict";s.d(t,{I:function(){return n}});var n=function(e){var t=e.dataCategories,s=e.mostLikelyCategories;return null!==t&&void 0!==t&&t.length?t:null!==s&&void 0!==s&&s.length?[s.reduce((function(e,t){var s,n;return(null!==(s=t.confidence)&&void 0!==s?s:0)>(null!==(n=e.confidence)&&void 0!==n?n:0)?t:e})).fides_key]:[]}},19665:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return $}});var n=s(28841),i=s(79894),r=s.n(i),a=s(86677),o=s(27378),c=s(60245),l=s(6848),d=s(48187),u=s(12187),f=s(51471),h=s(44047),y=s(48466),p=s(24246),g=function(e){var t=e.hideEmpty,s=e.onChange;return(0,p.jsx)(n.rsf,{colorScheme:"secondary",isChecked:t,onChange:function(e){return s(e.target.checked)}})},j=s(85859),v=s(72779),x=s(4938),m=s(90849),b=s(55732),O=s(97865),w=s(34707),k=s.n(w),S=s(34090),C=s(76649),P=s(43212),_=s(78624),E=s(24753),T=s(75523),D=s(1326),I=s(52562);function Z(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function z(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(s),!0).forEach((function(t){(0,m.Z)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Z(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var F=function(e){var t=e.headingLevel,s=e.title,i=e.children;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(n.X6q,{as:t,children:(0,p.jsxs)(n.KFZ,{_expanded:{color:"complimentary.500"},_hover:{bg:"gray.50"},pl:0,children:[(0,p.jsx)(n.xuv,{flex:"1",textAlign:"left",children:s}),(0,p.jsx)(n.XEm,{})]})}),(0,p.jsx)(n.Hk3,{py:2,px:0,children:i})]})},W=function(e){var t=e.flow,s=e.index,i=e.classifyDataFlows,r=e.type,a=(0,S.u6)().setFieldValue,o=(0,l.C)(T.qb),c=(0,l.C)(T.L5),d=null===i||void 0===i?void 0:i.find((function(e){return e.fides_key===t.fides_key})),u=null===d||void 0===d?void 0:d.classifications.map((function(e){var t=e.label,s=e.aggregated_score;return z(z({},c.get(t)),{},{fides_key:t,confidence:s})})),f=(0,I.I)({dataCategories:t.data_categories,mostLikelyCategories:u});return(0,p.jsx)(n.Qdk,{pl:4,borderBottom:"none","data-testid":"accordion-item-".concat(t.fides_key),children:(0,p.jsx)(F,{headingLevel:"h3",title:t.fides_key,children:o?(0,p.jsx)(n.xuv,{pr:2,children:(0,p.jsx)(n.P$4,{mostLikelyCategories:u||[],dataCategories:o,checked:f,onChecked:function(e){a("".concat(r,"[").concat(s,"].data_categories"),e)}})}):null})})},L=function(e){var t=e.classifyDataFlows,s=e.type,i=(0,S.u6)().values[s],r={ingress:"source",egress:"destination"}[s];return 0===i.length?(0,p.jsxs)(n.xvT,{p:4,children:["No ",s,"es found."]}):(0,p.jsx)(n.Qdk,{p:0,"data-testid":"accordion-item-".concat(s),children:(0,p.jsx)(F,{headingLevel:"h2",title:"Connected ".concat((0,D.G8)(r)," Systems"),children:i.map((function(e,n){return(0,p.jsx)(W,{flow:e,index:n,classifyDataFlows:t,type:s},e.fides_key)}))})})},N=function(e){var t=e.system,s=e.classificationInstance;return(null==t.ingress||0===t.ingress.length)&&(null==t.egress||0===t.egress.length)?(0,p.jsx)(n.xvT,{children:"No data flows found on this system."}):(0,p.jsxs)(n.Kqy,{children:[(0,p.jsx)(n.xvT,{fontWeight:"semibold",children:t.name}),(0,p.jsxs)(n.UQy,{allowMultiple:!0,pl:2,children:[(0,p.jsx)(L,{classifyDataFlows:null===s||void 0===s?void 0:s.ingress,type:"ingress"}),(0,p.jsx)(L,{classifyDataFlows:null===s||void 0===s?void 0:s.egress,type:"egress"})]})]})},R=s(51860);function A(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function M(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?A(Object(s),!0).forEach((function(t){(0,m.Z)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):A(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var q="data-flow-form",G=function(e){var t=e.label,s=e.value;return(0,p.jsxs)(n.P4e,{children:[(0,p.jsxs)(n.xvT,{as:"span",fontWeight:"semibold",children:[t,":"]})," ",s]})},V=function(e){return(0,C.Ln)({fides_key:"string"},e)},Y=function(e){var t,s,i=e.system,r=e.isOpen,a=e.onClose,o=function(e){var t=e.system,s=e.onClose,i=(0,n.pmc)();(0,T.MO)();var r,a=(0,h.$b)(t.fides_key),o=a.data,c=a.isLoading;if(null==o||V(o)){var l,d=t.ingress||[],u=t.egress||[],f=(null===o||void 0===o?void 0:o.ingress.filter((function(e){return d.find((function(t){return t.fides_key===e.fides_key}))})))||[],y=(null===o||void 0===o?void 0:o.egress.filter((function(e){return u.find((function(t){return t.fides_key===e.fides_key}))})))||[],g=f.length>0,j=y.length>0,v=!g&&!j,m=d.length>0,w=u.length>0,S=!m&&!w;l=m&&w?"which send or receive data from your selected system":m?"from which your selected system receives data":"to which your selected system sends data",r=(null===o||void 0===o?void 0:o.status)===x.Wg.PROCESSING?(0,p.jsx)(n.xvT,{fontSize:"sm","data-testid":"processing",children:"Fides classify is still classifying, please check back later."}):S?(0,p.jsx)(n.xvT,{fontSize:"sm","data-testid":"no-data-flows",children:"Fides classify did not detect any additional systems sending or receiving data from your selected system."}):v?(0,p.jsx)(n.xvT,{fontSize:"sm","data-testid":"no-classification",children:"Fides classify has detected additional systems which send or receive data from your selected system, but was unable to classify these data flows. You may classify these data flows manually below."}):(0,p.jsxs)(n.xvT,{fontSize:"sm","data-testid":"data-flow-with-classification",children:["Fides classify has detected additional systems ",l,". Each system has been automatically assigned data categories. Choose to keep the assigned data category selection or review more classification recommendations."]})}else r=(0,p.jsx)(n.xvT,{fontSize:"sm","data-testid":"no-classification-instance",children:"No classification instance found but you may still manually classify the data flows."});var C=(0,R.qQ)(),P=(0,O.Z)(C,1)[0],D=(0,h.MD)(),I=(0,O.Z)(D,1)[0],Z=function(){var e=(0,b.Z)(k().mark((function e(t){var n,r;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c&&o){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,P(t);case 5:if(n=e.sent,!(0,_.D4)(n)){e.next=9;break}return i((0,E.Vo)((0,_.e$)(n.error))),e.abrupt("return");case 9:return e.next=11,I({dataset_fides_key:t.fides_key,status:x.Wg.REVIEWED,resource_type:x.j.SYSTEMS});case 11:if(r=e.sent,!(0,_.D4)(r)){e.next=15;break}return i((0,E.Vo)((0,_.e$)(r.error))),e.abrupt("return");case 15:i((0,E.t5)("System data flows classified and approved")),s(),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2),i((0,E.Vo)("".concat(e.t0)));case 22:case"end":return e.stop()}}),e,null,[[2,19]])})));return function(t){return e.apply(this,arguments)}}();return{description:r,classificationInstance:o,isLoadingClassificationInstance:c,handleSave:Z}}({system:i,onClose:a}),c=o.description,l=o.isLoadingClassificationInstance,d=o.classificationInstance,u=o.handleSave,f=function(){var e=(0,b.Z)(k().mark((function e(t){var s,n;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.ingress,n=t.egress,e.next=3,u(M(M({},i),{},{ingress:s,egress:n}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y={egress:null!==(t=i.egress)&&void 0!==t?t:[],ingress:null!==(s=i.ingress)&&void 0!==s?s:[]},g=V(d)?d.status:void 0,j=g!==x.Wg.PROCESSING;return(0,p.jsx)(S.J9,{initialValues:y,onSubmit:f,children:function(e){var t=e.isSubmitting;return(0,p.jsx)(S.l0,{id:q,children:(0,p.jsx)(P.ZP,{isOpen:r,onClose:a,header:(0,p.jsx)(P.zR,{title:"System classification details"}),footer:g!==x.Wg.PROCESSING?(0,p.jsx)(P.Gn,{onClose:a,formId:q,isSaving:t}):void 0,children:l?(0,p.jsx)(n.M5Y,{children:(0,p.jsx)(n.$jN,{})}):(0,p.jsxs)(n.Kqy,{spacing:4,children:[(0,p.jsxs)(n.MIq,{columns:2,spacingY:2,children:[(0,p.jsx)(G,{label:"System name",value:i.name}),(0,p.jsx)(G,{label:"System type",value:i.system_type}),(0,p.jsx)(G,{label:"Classification status",value:(0,p.jsx)(v.Z,{status:g,resource:x.j.SYSTEMS,display:"inline"})})]}),c,j?(0,p.jsx)(N,{system:i,classificationInstance:V(d)?d:void 0}):null]})})})}})},K=function(e){var t=e.systems,s=(0,l.T)(),i=(0,l.C)(h.Oq),r=(0,l.C)(R.o5),a=(0,o.useState)(!1),c=a[0],d=a[1],u=c?t.filter((function(e){var t;return null===(t=i.get(e.fides_key))||void 0===t?void 0:t.has_labels})):t;return(0,p.jsxs)(n.Kqy,{children:[(0,p.jsxs)(n.kCb,{flexShrink:0,alignItems:"center",children:[(0,p.jsx)(n.xvT,{fontSize:"xs",mr:2,size:"sm",children:"Only Show Findings"}),(0,p.jsx)(g,{hideEmpty:c,onChange:d})]}),(0,p.jsxs)(n.iA_,{size:"sm","data-testid":"systems-classify-table",children:[(0,p.jsx)(n.hrZ,{children:(0,p.jsxs)(n.Tr,{children:[(0,p.jsx)(n.Th,{children:"System Name"}),(0,p.jsx)(n.Th,{maxWidth:"100px",children:"Classification Status"})]})}),(0,p.jsx)(n.p3B,{children:u.map((function(e){var t=i.get(e.fides_key);return(0,p.jsxs)(n.Tr,{"data-testid":"row-".concat(e.fides_key),_hover:{bg:"gray.50"},cursor:"pointer",onClick:function(){return function(e){s((0,R.Pj)(e.fides_key))}(e)},children:[(0,p.jsx)(n.Td,{children:(0,p.jsx)(j.Rt,{system:e,attribute:"name"})}),(0,p.jsx)(n.Td,{"data-testid":"status-".concat(e.fides_key),children:(0,p.jsx)(v.Z,{resource:x.j.SYSTEMS,status:null===t||void 0===t?void 0:t.status})})]},e.fides_key)}))})]}),r?(0,p.jsx)(Y,{system:r,isOpen:null!=r,onClose:function(){return s((0,R.Pj)(void 0))}}):null]})},X=function(e){var t=e.children;return(0,p.jsx)(f.Z,{title:"Classify Systems",children:(0,p.jsxs)(n.Kqy,{spacing:4,children:[(0,p.jsx)(n.X6q,{fontSize:"2xl",fontWeight:"semibold",children:"Classified systems"}),t]})})},$=function(){var e=(0,a.useRouter)(),t=(0,c.I0)(),s=(0,u.V)().systemOrDatamapRoute,i=(0,h.x8)(),f=i.isSuccess,g=i.isLoading,j=(0,l.C)(y.PG),v=(0,y.K3)(void 0,{skip:!f||j&&j.length>0}),m=v.isLoading,b=v.data,O=j||b;(0,o.useEffect)((function(){b&&b.length&&t((0,y.Wc)(b))}),[t,b]);var w=(0,d.w)({resourceType:x.j.SYSTEMS,fidesKeys:null===O||void 0===O?void 0:O.map((function(e){return e.fides_key})),skip:!f}),k=w.isLoading,S=w.data,C=w.isClassificationFinished;return(0,o.useEffect)((function(){g||f||e.push("/")}),[e,f,g]),m||k?(0,p.jsx)(X,{children:(0,p.jsx)(n.$jN,{})}):S&&0!==S.length?(0,p.jsxs)(X,{children:[(0,p.jsx)(n.xvT,{children:C?"All systems have been classifed by Fides.":"Systems are still being classified by Fides."}),O&&O.length?(0,p.jsx)(K,{systems:O}):"No systems with classifications found",(0,p.jsx)(n.Ugi,{children:(0,p.jsx)(r(),{href:s,passHref:!0,children:(0,p.jsx)(n.zxk,{variant:"primary",size:"sm",children:"Finish"})})})]}):(0,p.jsx)(X,{children:(0,p.jsx)(n.xvT,{"data-testid":"no-classifications",children:"No classifications found. Have you run a scan?"})})}},18533:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/classify-systems",function(){return s(19665)}])}},function(e){e.O(0,[8346,9774,2888,179],(function(){return t=18533,e(e.s=t);var t}));var t=e.O();_N_E=t}]);