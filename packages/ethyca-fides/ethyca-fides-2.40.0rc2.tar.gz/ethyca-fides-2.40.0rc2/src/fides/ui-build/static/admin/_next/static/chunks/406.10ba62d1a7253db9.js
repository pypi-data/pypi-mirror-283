"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[406],{60406:function(e,r,n){n.r(r),n.d(r,{default:function(){return k}});var t=n(28841),i=n(6848),s=n(30199),o=n(90849),a=n(55732),l=n(97865),c=n(34707),u=n.n(c),f=n(34090),d=n(27378),m=n(14633),h=n(78624),p=n(9408),x=n(90089),g=n(24246),y=["isRequired"],j=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,v=(0,t.Gpc)((function(e,r){var n=e.isRequired,i=void 0!==n&&n,s=(0,x.Z)(e,y),o=s.form.values.emails,a=(0,d.useState)(""),l=a[0],c=a[1],u=function(e){e.map((function(e){return e.trim()})).filter((function(e){return function(e){return j.test(e)}(e)&&!function(e){return o.includes(e)}(e)})).forEach((function(e){return s.push(e)})),c("")};return(0,g.jsxs)(t.NIc,{alignItems:"baseline",display:"inline-flex",isInvalid:!!s.form.errors[s.name],isRequired:i,children:[(0,g.jsx)(t.lXp,{fontSize:"md",htmlFor:"email",children:"Email"}),(0,g.jsxs)(t.gCW,{align:"flex-start",w:"inherit",children:[(0,g.jsx)(t.IIB,{autoComplete:"off",placeholder:"Type or paste email addresses separated by commas and press `Enter` or `Tab`...",onChange:function(e){c(e.target.value)},onKeyDown:function(e){["Enter","Tab",","].includes(e.key)&&(e.preventDefault(),u([l]))},onPaste:function(e){e.preventDefault();var r=e.clipboardData.getData("text").split(",");u(r)},ref:r,size:"sm",type:"email",value:l}),(0,g.jsx)(t.J1D,{children:s.form.errors[s.name]}),o.length>0&&(0,g.jsx)(t.Eq9,{spacing:1,mb:3,pt:"8px",children:o.map((function(e,r){return(0,g.jsxs)(t.Vp9,{borderRadius:"full",backgroundColor:"primary.400",color:"white",size:"sm",variant:"solid",children:[(0,g.jsx)(t.Sn0,{children:e}),(0,g.jsx)(t.SD9,{onClick:function(){s.remove(r)}})]},e)}))})]})]})})),b=n(51365);function C(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function O(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?C(Object(n),!0).forEach((function(r){(0,o.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var w=m.Ry().shape({emails:m.IX(m.Z_()).when(["notify"],{is:!0,then:m.IX(m.Z_()).min(1,"Must enter at least one valid email").label("Email")}),notify:m.O7(),minErrorCount:m.Rx().required()}),S=function(){var e=(0,t.qY0)(),r=e.isOpen,n=e.onOpen,i=e.onClose,s=(0,d.useState)({emails:[],notify:!1,minErrorCount:1}),o=s[0],c=s[1],m=(0,d.useRef)(null),x=(0,p.VY)(),y=x.errorAlert,j=x.successAlert,C=(0,d.useState)(!0),S=C[0],k=C[1],E=(0,b.tE)(void 0,{skip:S}).data,D=(0,b.SC)(),P=(0,l.Z)(D,1)[0],R=function(){var e=(0,a.Z)(u().mark((function e(r,n){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setSubmitting(!0),e.next=3,P({email_addresses:r.emails,notify_after_failures:r.notify?r.minErrorCount:0});case 3:"error"in(t=e.sent)?y((0,h.e$)(t.error),"Configure alerts and notifications has failed to save due to the following:"):j("Configure alerts and notifications saved successfully."),n.setSubmitting(!1),i();case 7:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}();return(0,d.useEffect)((function(){r&&k(!1),E&&c({emails:E.email_addresses,notify:0!==E.notify_after_failures,minErrorCount:E.notify_after_failures})}),[E,r]),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(t.hU,{onClick:n,variant:"outline",size:"xs",title:"Configure alerts","aria-label":"Configure alerts",icon:(0,g.jsx)(t.Dkj,{})}),(0,g.jsx)(f.J9,{enableReinitialize:!0,initialValues:o,onSubmit:R,validationSchema:w,children:function(e){return(0,g.jsxs)(t.dys,{isOpen:r,placement:"right",initialFocusRef:m,onClose:function(){e.resetForm(),i()},size:"lg",children:[(0,g.jsx)(t.P1B,{}),(0,g.jsxs)(t.scA,{color:"gray.900",children:[(0,g.jsx)(t.cCv,{}),(0,g.jsxs)(t.OXI,{color:"gray.900",children:[(0,g.jsx)(t.xvT,{fontSize:"2xl",fontWeight:"normal",mb:4,children:"Configure alerts and notifications"}),(0,g.jsx)(t.xuv,{mt:"26px",children:(0,g.jsx)(t.xvT,{fontSize:"md",fontWeight:"normal",children:"Setup your alerts to send you a notification when there are any processing failures. You can also setup a threshold for connector failures for Fides to notify you after X amount of failures have occurred."})})]}),(0,g.jsx)(t.Ng0,{mt:"20px",children:(0,g.jsxs)(f.l0,{id:"configure-alerts-form",noValidate:!0,children:[(0,g.jsx)(t.xvT,{fontSize:"md",children:"Contact details"}),(0,g.jsxs)(t.gCW,{align:"stretch",gap:"29px",mt:"14px",children:[(0,g.jsx)(t.Ugi,{children:(0,g.jsx)(f.F2,{name:"emails",render:function(r){return(0,g.jsx)(v,O(O({},r),{},{isRequired:e.values.notify,ref:m}))}})}),(0,g.jsx)(t.Ugi,{children:(0,g.jsx)(f.gN,{id:"notify",name:"notify",children:function(r){var n=r.field;return(0,g.jsxs)(t.NIc,{alignItems:"center",display:"flex",mt:"45px",children:[(0,g.jsx)(t.lXp,{fontSize:"md",mb:"0",children:"Notify me immediately if there are any DSR processing errors"}),(0,g.jsx)(t.rsf,O(O({},n),{},{colorScheme:"secondary",isChecked:e.values.notify,onChange:function(r){n.onChange(r),e.setFieldValue("minErrorCount",1),r.target.checked||setTimeout((function(){e.setFieldTouched("emails",!1)}),0)}}))]})}})})]}),(0,g.jsx)(t.xvT,{color:"#757575",fontSize:"sm",mt:"11px",children:"If selected, then Fides will notify you by your chosen method of communication every time the system encounters a data subject request processing error. You can turn this off anytime and setup a more suitable notification method below if you wish."}),e.values.notify&&(0,g.jsx)(t.Ugi,{mt:"34px",children:(0,g.jsx)(f.gN,{id:"minErrorCount",name:"minErrorCount",children:function(r){var n=r.field,i=r.meta;return(0,g.jsxs)(t.NIc,{alignItems:"center",display:"flex",isInvalid:!(!i.error||!i.touched),isRequired:!0,children:[(0,g.jsx)(t.xvT,{children:"Notify me after"}),(0,g.jsxs)(t.Y2U,{allowMouseWheel:!0,color:"gray.700",defaultValue:e.values.minErrorCount||1,min:1,ml:"8px",mr:"8px",onChange:function(r,n){e.setFieldValue("minErrorCount",n)},size:"sm",w:"80px",children:[(0,g.jsx)(t.zuI,O({},n)),(0,g.jsxs)(t.FiK,{children:[(0,g.jsx)(t.WQu,{}),(0,g.jsx)(t.Y_d,{})]})]}),(0,g.jsx)(t.xvT,{children:"DSR processing errors "})]})}})})]})}),(0,g.jsx)(t.zeN,{justifyContent:"flex-start",children:(0,g.jsxs)(t.hE2,{size:"sm",spacing:"8px",variant:"outline",children:[(0,g.jsx)(t.zxk,{onClick:function(){e.resetForm(),i()},variant:"outline",children:"Cancel"}),(0,g.jsx)(t.zxk,{bg:"primary.800",color:"white",form:"configure-alerts-form",isDisabled:e.isSubmitting,isLoading:e.isSubmitting,loadingText:"Submitting",size:"sm",variant:"solid",type:"submit",_active:{bg:"primary.500"},_hover:{bg:"primary.400"},children:"Save"})]})})]})]})}})]})},k=function(){var e=(0,i.C)(b.fe).errorRequests;return(0,g.jsxs)(t.kCb,{gap:4,children:[(null===e||void 0===e?void 0:e.length)>0&&(0,g.jsx)(s.Z,{buttonProps:{size:"xs"}}),(0,g.jsx)(S,{})]})}},30199:function(e,r,n){var t=n(90849),i=n(55732),s=n(97865),o=n(34707),a=n.n(o),l=n(28841),c=n(27378),u=n(6848),f=n(78624),d=n(9408),m=n(51365),h=n(24246);function p(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function x(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?p(Object(n),!0).forEach((function(r){(0,t.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var g=(0,l.Gpc)((function(e,r){var n=e.buttonProps,t=e.handleBlur,o=e.subjectRequest,p=(0,u.T)(),g=(0,c.useState)(!1),y=g[0],j=g[1],v=(0,d.VY)(),b=v.errorAlert,C=v.successAlert,O=(0,u.C)(m.fe).errorRequests,w=(0,m.JD)(),S=(0,s.Z)(w,1)[0],k=(0,m.Fq)(),E=(0,s.Z)(k,1)[0],D=function(){var e=(0,i.Z)(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.next=3,S(O);case 3:"error"in(r=e.sent)?(p((0,m.uT)({checkAll:!1,errorRequests:[]})),b((0,f.e$)(r.error),"DSR batch automation has failed due to the following:",{duration:null})):(r.data.failed.length>0&&b((0,h.jsxs)(l.xuv,{children:["DSR automation has failed for"," ",(0,h.jsx)(l.xvT,{as:"span",fontWeight:"semibold",children:r.data.failed.length})," ","privacy request(s). Please review the event log for further details."]}),void 0,{containerStyle:{maxWidth:"max-content"},duration:null}),r.data.succeeded.length>0&&C("Privacy request(s) are now being reprocessed.")),j(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,i.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}return e.abrupt("return");case 2:return j(!0),e.next=5,E(o);case 5:"error"in(n=e.sent)?b((0,f.e$)(n.error),"DSR automation has failed for this privacy request due to the following:",{duration:null}):C("Privacy request is now being reprocessed."),j(!1),t&&t(r);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,h.jsx)(l.zxk,x(x({},n),{},{isDisabled:y,isLoading:y,loadingText:"Reprocessing",onClick:o?P:D,ref:r,spinnerPlacement:"end",leftIcon:(0,h.jsx)(l.AyE,{}),variant:"outline",_loading:{opacity:1,div:{opacity:.4}},children:"Reprocess"}))}));r.Z=g}}]);