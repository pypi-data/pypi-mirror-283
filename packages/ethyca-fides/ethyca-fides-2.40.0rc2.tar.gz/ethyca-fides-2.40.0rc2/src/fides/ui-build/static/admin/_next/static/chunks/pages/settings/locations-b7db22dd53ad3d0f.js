(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2462],{22687:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return q}});var i=t(28841),o=t(6848),r=t(51471),c=t(55732),s=t(97865),a=t(34707),l=t.n(a),u=t(98784),d=t.n(u),f=t(86677),h=t(27378),g=t(78624),p=t(2458),m=t(44845),x=t(24753),j=t(33167),v=t(60709),y=t(27808),C=t(90849),b=t(73679),O=t(53333),w=t(38687),S=t(24246),k=function(e){var n=e.id,t=e.isChecked,o=e.onChange;return(0,S.jsxs)(i.kCb,{alignItems:"center",gap:"8px",children:[(0,S.jsx)(i.rsf,{isChecked:t,size:"sm",onChange:o,colorScheme:"complimentary",id:n,"data-testid":"regulated-toggle"}),(0,S.jsx)(i.lXp,{fontSize:"sm",m:0,htmlFor:n,children:"Regulated"}),(0,S.jsx)(w.Z,{label:"Toggle on to see only locations in this region with privacy regulations supported by Fides"})]})},Z=t(11993),_=t(90131),E=t(93246),P=function(e){var n=e.groups,t=e.locations,o=e.isOpen,r=e.onClose,c=e.selected,a=e.onChange,l=(0,h.useState)(c),u=l[0],d=l[1],f=(0,h.useState)(!1),g=f[0],p=f[1],m=(0,h.useMemo)((function(){var e=g?t.filter((function(e){var n;return null===(n=e.regulation)||void 0===n?void 0:n.length})):t;return{locationsByGroup:(0,E.VT)(e),filteredLocations:e}}),[t,g]),x=m.filteredLocations,j=m.locationsByGroup,v=(0,Z.QZ)({items:x,selected:u,onChange:d}),y=v.allSelected,C=v.handleToggleAll,b=v.handleToggleSelection,O=u.filter((function(e){return!Object.keys(j).includes(e)})).length,w=t[0].continent,P=Object.keys(j),z=!(1===P.length&&"Other"===P[0]);return(0,S.jsxs)(i.u_l,{size:"2xl",isOpen:o,onClose:r,isCentered:!0,children:[(0,S.jsx)(i.ZAr,{}),(0,S.jsxs)(i.hzk,{"data-testid":"subgroup-modal",children:[(0,S.jsx)(_.h4,{title:"Select locations"}),(0,S.jsxs)(i.fef,{p:6,maxHeight:"70vh",overflowY:"auto",children:[(0,S.jsx)(_.x$,{title:w,allSelected:y,onToggleAll:C,numSelected:O,children:(0,S.jsx)(k,{id:"".concat(w,"-modal-regulated"),isChecked:g,onChange:function(){return p(!g)}})}),z?(0,S.jsx)(i.UQy,{allowToggle:!0,allowMultiple:!0,children:Object.entries(j).map((function(e){var t=(0,s.Z)(e,2),o=t[0],r=t[1],c=n.find((function(e){return o===e.id})),a=c?c.name:o;return(0,S.jsxs)(i.Qdk,{"data-testid":"".concat(a,"-accordion"),children:[(0,S.jsx)("h2",{children:(0,S.jsxs)(i.KFZ,{children:[(0,S.jsx)(i.xuv,{as:"span",flex:"1",textAlign:"left",fontWeight:"semibold",fontSize:"sm",children:a}),(0,S.jsx)(i.XEm,{})]})}),(0,S.jsx)(i.Hk3,{pb:4,children:(0,S.jsx)(i.MIq,{columns:3,spacing:6,children:r.map((function(e){return(0,S.jsx)(i.XZJ,{size:"sm",colorScheme:"complimentary",isChecked:u.includes(e.id),onChange:function(){return b(e.id)},"data-testid":"".concat(e.name,"-checkbox"),children:e.name},e.id)}))})})]},o)}))}):(0,S.jsx)(i.MIq,{columns:3,spacing:6,paddingInline:4,children:x.map((function(e){return(0,S.jsx)(i.XZJ,{size:"sm",colorScheme:"complimentary",isChecked:u.includes(e.id),onChange:function(){return b(e.id)},"data-testid":"".concat(e.name,"-checkbox"),children:e.name},e.id)}))})]}),(0,S.jsx)(_.$_,{onApply:function(){var e=new Set(u);Object.entries(j).forEach((function(n){var t=(0,s.Z)(n,2),i=t[0];t[1].every((function(e){return u.includes(e.id)}))?e.add(i):e.delete(i)})),a(Array.from(e)),r()},onClose:r})]})]})};function z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function L(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?z(Object(t),!0).forEach((function(n){(0,C.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):z(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var T=function(e){var n=e.title,t=e.groups,o=e.locations,r=e.selected,c=e.onChange,s=e.search,a=(0,i.qY0)(),l=(0,h.useState)(!1),u=l[0],d=l[1],f=!(null===s||void 0===s||!s.length),g=t.length>0,p=o;t.length&&(p=t),f&&(p=[].concat((0,b.Z)(o),(0,b.Z)(t)).sort((function(e,n){return e.name.localeCompare(n.name)})));var m=u?p.filter((function(e){return(0,E.$q)(e,o)})):p,x=s?m.filter((function(e){return function(e,n){var t;return null===(t=e.name)||void 0===t?void 0:t.toLocaleLowerCase().includes(n.toLocaleLowerCase())}(e,s)})):m,j=t.filter((function(e){return"checked"===(0,E.ji)({group:e,selected:r,locations:o})})).map((function(e){return e.id})),v=t.filter((function(e){return"indeterminate"===(0,E.ji)({group:e,selected:r,locations:o})})).map((function(e){return e.id})),y=g?[].concat((0,b.Z)(j),(0,b.Z)(r)):r,C=r.length,w=function(e){var n=o.map((function(n){return e.includes(n.id)?L(L({},n),{},{selected:!0}):L(L({},n),{},{selected:!1})}));c(n)};return 0===x.length&&s?null:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(O.ZP,{title:n,items:x,selected:y,indeterminate:g?v:[],onChange:function(e){var n=new Set(e),i=new Set(y);e.forEach((function(e){i.has(e)||t.find((function(n){return n.id===e}))&&o.filter((function(n){var t;return null===(t=n.belongs_to)||void 0===t?void 0:t.includes(e)})).forEach((function(e){n.add(e.id)}))})),i.forEach((function(e){n.has(e)||t.find((function(n){return n.id===e}))&&o.filter((function(n){var t;return null===(t=n.belongs_to)||void 0===t?void 0:t.includes(e)})).forEach((function(e){n.delete(e.id)}))})),w(Array.from(n))},onViewMore:function(){a.onOpen()},numSelected:C,toggle:(0,S.jsx)(k,{id:"".concat(n,"-regulated"),isChecked:u,onChange:function(){return d(!u)}})}),(0,S.jsx)(P,{groups:t,locations:o,isOpen:a.isOpen,onClose:a.onClose,selected:r,onChange:w},"subgroup-modal-selected-".concat(y.length))]})},A=t(17165),M=function(e){var n,t=e.data,o=(0,i.pmc)(),r=(0,i.qY0)(),a=(0,h.useState)(null!==(n=t.locations)&&void 0!==n?n:[]),u=a[0],C=a[1],b=(0,h.useState)(""),O=b[0],w=b[1],k=(0,A.WA)(),Z=(0,s.Z)(k,2),_=Z[0],P=Z[1].isLoading,z=(0,h.useMemo)((function(){return(0,E.Il)(t.locations||[],t.location_groups||[])}),[t]),L=!d().isEqual(u,t.locations),M=(0,f.useRouter)(),q=function(){M.push(v.vY).then((function(){o.closeAll()}))},F=function(){var e=(0,c.Z)(l().mark((function e(){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_({locations:u.map((function(e){return{id:e.id,selected:e.selected}})),regulations:[]});case 2:n=e.sent,(0,j.isErrorResult)(n)?o((0,x.Vo)((0,g.e$)(n.error))):o((0,x.t5)((0,S.jsxs)(i.xvT,{display:"inline",children:["Fides has automatically associated the relevant regulations with your location choices."," ",(0,S.jsx)(y.Z,{onClick:q,children:"View regulations here."})]})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(e){var n=u.map((function(n){var t=e.find((function(e){return e.id===n.id}));return null!==t&&void 0!==t?t:n}));C(n)};return(0,S.jsxs)(i.gCW,{alignItems:"start",spacing:4,children:[(0,S.jsx)(i.xuv,{maxWidth:"510px",width:"100%",children:(0,S.jsx)(m.Z,{onChange:w,placeholder:"Search",search:O,onClear:function(){return w("")},"data-testid":"search-bar"})}),(0,S.jsx)(i.MIq,{columns:{base:1,md:2,xl:3},spacing:6,width:"100%",children:Object.entries(z).map((function(e){var n=(0,s.Z)(e,2),t=n[0],i=n[1];return(0,S.jsx)(T,{title:t,groups:i.locationGroups,locations:i.locations,selected:u.filter((function(e){return i.locations.find((function(n){return n.id===e.id}))&&e.selected})).map((function(e){return e.id})),onChange:I,search:O},t)}))}),(0,S.jsx)(p.Z,{isOpen:r.isOpen,onClose:r.onClose,onConfirm:function(){F(),r.onClose()},title:"Regulation updates",message:"Modifications in your location settings may also affect your regulation settings to simplify management. You can override any Fides-initiated changes directly in the regulation settings.",isCentered:!0,icon:(0,S.jsx)(i.aNP,{color:"orange"})}),L?(0,S.jsx)(i.zxk,{colorScheme:"primary",size:"sm",onClick:r.onOpen,isLoading:P,"data-testid":"save-btn",children:"Save"}):null]})},q=function(){var e=(0,A.QM)().isLoading,n=(0,o.C)(A.P8);return(0,S.jsx)(r.Z,{title:"Locations",children:(0,S.jsxs)(i.xuv,{"data-testid":"location-management",children:[(0,S.jsx)(i.X6q,{marginBottom:2,fontSize:"2xl",children:"Locations"}),(0,S.jsxs)(i.xuv,{children:[(0,S.jsx)(i.xvT,{marginBottom:4,fontSize:"sm",maxWidth:"720px",children:"Select the locations that you operate in and Fides will make sure that you are automatically presented with the relevant regulatory guidelines and global frameworks for your locations."}),(0,S.jsx)(i.xuv,{children:e?(0,S.jsx)(i.$jN,{}):(0,S.jsx)(M,{data:n})})]})]})})}},40135:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/locations",function(){return t(22687)}])}},function(e){e.O(0,[8033,7227,9774,2888,179],(function(){return n=40135,e(e.s=n);var n}));var n=e.O();_N_E=n}]);