"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6523],{30646:function(e,n,t){var i=t(28841),a=t(24246);n.Z=function(e){var n=e.title,t=e.children,r=e.isOpen,s=e.onClose;return(0,a.jsxs)(i.u_l,{isOpen:r,onClose:s,isCentered:!0,scrollBehavior:"inside",size:"xl",children:[(0,a.jsx)(i.ZAr,{}),(0,a.jsxs)(i.hzk,{textAlign:"left",p:0,"data-testid":"add-modal-content",children:[(0,a.jsx)(i.xBx,{p:0,children:(0,a.jsx)(i.xuv,{backgroundColor:"gray.50",px:6,py:4,border:"1px",borderColor:"gray.200",borderTopRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center",children:(0,a.jsx)(i.X6q,{as:"h3",size:"sm",children:n})})}),(0,a.jsx)(i.fef,{pb:4,overflow:"scroll",children:t})]})]})}},36523:function(e,n,t){t.d(n,{Z:function(){return R}});var i=t(90849),a=t(90089),r=t(55732),s=t(97865),o=t(34707),c=t.n(o),d=t(28841),l=t(34090),u=t(27378),p=t(14633),v=t(6848),m=t(90768),f=t(43139),g=t(37761),y=t(44047),h=t(48466),b=t(51745),_=t(2398),x=t(88491),k=t(78624),j=t(24753),C=t(30646),O={name:"",consent_use:"",data_use:"",data_categories:["user"],cookieNames:[],cookies:[]},w=[{label:"Analytics",value:"analytics",description:"Provides analytics for activities such as system and advertising performance reporting, insights and fraud detection."},{label:"Essential",value:"essential",description:"Operates the service or product, including legal obligations, support and basic system operations."},{label:"Functional",value:"functional",description:"Used for specific, necessary, and legitimate purposes."},{label:"Marketing",value:"marketing",description:"Enables marketing, promotion, advertising and sales activities for the product, service, application or system."}],S=t(75846),V=t(16446),z=t(24246),P=function(e){var n=e.index,t=e.isSuggestion,i=e.disabled;(0,S.fd)();var a=(0,v.C)(S.oW),r=t?"complimentary.500":"gray.800",s=(0,l.u6)().values,o=a.filter((function(e){return e.value.split(".")[0]===s.privacy_declarations[n].consent_use}));return(0,z.jsxs)(d.gCW,{width:"100%",borderRadius:"4px",border:"1px solid",borderColor:"gray.200",spacing:4,p:4,children:[(0,z.jsx)(f.AP,{label:"Consent category",tooltip:"What is the system using the data for. For example, is it for third party advertising or perhaps simply providing system operations.",name:"privacy_declarations.".concat(n,".consent_use"),options:w,variant:"stacked",isRequired:!0,isCustomOption:!0,singleValueBlock:!0,textColor:r,isDisabled:i}),(0,z.jsx)(f.AP,{label:"Detailed consent category (optional)",tooltip:"Select a more specific consent category",name:"privacy_declarations.".concat(n,".data_use"),options:o,variant:"stacked",isCustomOption:!0,singleValueBlock:!0,textColor:r,isDisabled:!s.privacy_declarations[n].consent_use||i}),(0,z.jsx)(f.VT,{label:"Cookie names",name:"privacy_declarations.".concat(n,".cookieNames"),options:[],variant:"stacked",isMulti:!0,textColor:r,isDisabled:i})]})},D=function(e){var n,t,i=e.showSuggestions,a=e.isCreate,r=e.disabled,s=(0,l.u6)(),o=s.values,c=s.setFieldValue,p=o.vendor_id,m=(0,y.Wp)({vendor_id:p},{skip:!i||null==p}).isLoading,f=(0,v.C)((0,y.cL)(p||""));(0,u.useEffect)((function(){if(i&&o.vendor_id&&null!==f&&void 0!==f&&f.length){var e=f.filter((function(e){return n=e.data_use,w.some((function(e){return e.value===n.split(".")[0]}));var n})).map((function(e){return(0,V.U)(e)})).map((function(e){var n,t,i;return{name:null!==(n=e.name)&&void 0!==n?n:"",consent_use:e.data_use.split(".")[0],data_use:e.data_use,data_categories:e.data_categories,cookieNames:(null===(t=e.cookies)||void 0===t?void 0:t.map((function(e){return e.name})))||[],cookies:null!==(i=e.cookies)&&void 0!==i?i:[]}}));c("privacy_declarations",e)}else a&&c("privacy_declarations",[O])}),[i,a,o.vendor_id,f,c]);var g=(null===(n=o.privacy_declarations[o.privacy_declarations.length-1])||void 0===n?void 0:n.data_use)===O.data_use&&(null===(t=o.privacy_declarations[o.privacy_declarations.length-1])||void 0===t?void 0:t.consent_use)===O.consent_use;return m?(0,z.jsx)(d.$jN,{size:"sm",alignSelf:"center"}):(0,z.jsx)(l.F2,{name:"privacy_declarations",render:function(e){return(0,z.jsxs)(z.Fragment,{children:[o.privacy_declarations.map((function(e,n){return(0,z.jsx)(P,{index:n,disabled:r,isSuggestion:i},e.data_use||n)})),(0,z.jsx)(d.zxk,{size:"xs",variant:"ghost",colorScheme:"complimentary",onClick:function(){e.push(O)},disabled:g||r,"data-testid":"add-data-use-btn",children:"Add data use +"})]})}})},E=["cookieNames","consent_use"];function Z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Z(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Z(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var F={name:"",vendor_id:void 0,privacy_declarations:[O]},R=function(e){var n=e.buttonLabel,t=e.buttonVariant,i=void 0===t?"primary":t,o=e.onButtonClick,w=(0,d.pmc)(),S=(0,d.qY0)(),V=S.isOpen,P=S.onOpen,Z=S.onClose,R=(0,v.T)(),q=(0,v.C)(h.cS),A=(0,u.useMemo)((function(){return p.Ry().shape({name:p.Z_().required().label("Vendor name").test("is-unique","",(function(e,n){return!q.map((function(e){return e.name})).some((function(n){return n===e}))||n.createError({message:'You already have a vendor called "'.concat(e,'". Please specify a unique name for this vendor.')})}))})}),[q]),L=(0,m.hz)(),W=L.tcf,B=L.dictionaryService,M=(0,y.Rd)(void 0,{skip:!B}).isLoading,Q=(0,v.C)(y.o),G=(0,v.C)(b.gU),T=(0,h.f7)(),U=(0,s.Z)(T,1)[0],$=(0,v.C)(b.bN),I=function(){Z(),R((0,b.b3)("initial")),R((0,b.gQ)(!1))},Y=(0,u.useRef)(null),J=Y.current?Y.current.values.vendor_id:void 0,X=(0,v.C)((0,y.$e)(J||"")),H=function(){var e=(0,r.Z)(c().mark((function e(n,t){var i,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.privacy_declarations.filter((function(e){return e.consent_use!==O.consent_use})).flatMap((function(e){var n=e.cookieNames.map((function(n){var t=e.cookies.find((function(e){return e.name===n}));return null!==t&&void 0!==t?t:{name:n,path:"/"}})),t=(e.cookieNames,e.consent_use,(0,a.Z)(e,E));return"marketing"!==e.consent_use||e.data_use?N(N({},t),{},{data_use:e.data_use?e.data_use:e.consent_use,cookies:n}):["marketing.advertising.first_party.targeted","marketing.advertising.third_party.targeted"].map((function(e){return N(N({},t),{},{data_use:e,cookies:n})}))})),r=N(N(N({},X),n),{},{fides_key:(0,g.E)(n.name),system_type:"",privacy_declarations:i}),e.next=4,U(r);case 4:if(s=e.sent,!(0,k.D4)(s)){e.next=8;break}return w((0,j.Vo)((0,k.e$)(s.error))),e.abrupt("return");case 8:w((0,j.t5)("Vendor successfully created!")),t.resetForm(),I();case 11:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),K=function(e){if(B){if(!e)return R((0,b.b3)("hiding")),void R((0,b.gQ)(!1));R((0,b.b3)("showing")),W&&(0,k.cj)(e)===k.c6.GVL?R((0,b.gQ)(!0)):R((0,b.gQ)(!1))}},ee="primary"===i?{size:"sm",colorScheme:"primary"}:{size:"xs",variant:"outline"};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(d.zxk,N(N({onClick:function(){o?o():P()},"data-testid":"add-vendor-btn"},ee),{},{children:n})),(0,z.jsx)(l.J9,{initialValues:F,enableReinitialize:!0,onSubmit:H,validationSchema:A,innerRef:Y,children:function(e){var n=e.dirty,t=e.isValid,i=e.resetForm;return(0,z.jsx)(C.Z,{isOpen:V,onClose:I,title:"Add a vendor",children:(0,z.jsxs)(d.xuv,{"data-testid":"add-vendor-modal-content",my:4,children:[G?(0,z.jsx)(_.Z,{}):null,(0,z.jsx)(l.l0,{children:(0,z.jsxs)(d.gCW,{alignItems:"start",spacing:6,children:[B?(0,z.jsx)(x.Z,{label:"Vendor name",options:Q,onVendorSelected:K,isCreate:!0,lockedForGVL:G}):(0,z.jsx)(f.j0,{id:"name",name:"name",isRequired:!0,label:"Vendor name",tooltip:"Give the system a unique, and relevant name for reporting purposes. e.g. \u201cEmail Data Warehouse\u201d",variant:"stacked"}),(0,z.jsx)(D,{showSuggestions:"showing"===$,isCreate:!0,disabled:G}),(0,z.jsxs)(d.hE2,{size:"sm",width:"100%",justifyContent:"space-between",children:[(0,z.jsx)(d.zxk,{variant:"outline",onClick:function(){I(),i()},children:"Cancel"}),(0,z.jsx)(d.zxk,{type:"submit",variant:"primary",isDisabled:M||!n||!t,isLoading:M,"data-testid":"save-btn",children:"Save vendor"})]})]})})]})})}})]})}}}]);