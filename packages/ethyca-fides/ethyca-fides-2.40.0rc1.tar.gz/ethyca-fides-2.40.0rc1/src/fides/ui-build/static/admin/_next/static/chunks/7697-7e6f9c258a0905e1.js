(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7697],{63238:function(e,t,n){"use strict";n.d(t,{Tg:function(){return a}});var s=n(6848),r=n(67788),i=n(24246),a=function(e){return(0,s.C)(r.uu).filter((function(t){return e.includes(t)})).length>0};t.ZP=function(e){var t=e.scopes,n=e.children;return a(t)?(0,i.jsx)(i.Fragment,{children:n}):null}},88486:function(e,t,n){"use strict";n.d(t,{Gt:function(){return f},eB:function(){return m},oI:function(){return u}});var s=n(34090),r=n(27378),i=n(6848),a=n(30691),o=n(2458),c=n(24246),d=(0,r.createRef)(),l=(0,r.createRef)(),u=function(){var e=(0,i.T)(),t=(0,i.C)(a.DB),n=(0,r.useCallback)((function(){l.current=void 0,d.current=void 0}),[]),s=(0,r.useCallback)((function(){e((0,a.Mr)()),l.current&&(l.current(!0),n())}),[e,n]),o=(0,r.useCallback)((function(){e((0,a.Mr)()),l.current&&(l.current(!1),n())}),[e,n]);return{attemptAction:(0,r.useCallback)((function(){return t?(e((0,a.h7)()),d.current||(d.current=new Promise((function(e){l.current=e}))),d.current):Promise.resolve(!0)}),[t,e]),onConfirm:s,onClose:o}},f=function(e){var t=e.id,n=e.name,o=(0,s.u6)().dirty,c=(0,i.T)();return(0,r.useEffect)((function(){return c((0,a.Zu)({id:t,name:n})),function(){c((0,a.dz)({id:t}))}}),[c,t,n]),(0,r.useEffect)((function(){c((0,a.$p)({id:t,isDirty:o}))}),[o,c,t]),null},m=function(){var e=u(),t=e.onConfirm,n=e.onClose,s=(0,i.C)(a.uv);return(0,c.jsx)(o.Z,{isOpen:s,onClose:n,onConfirm:t,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},89348:function(e,t,n){"use strict";n.d(t,{q:function(){return z}});var s=n(28841),r=n(27378),i=n(90849),a=n(55732),o=n(97865),c=n(34707),d=n.n(c),l=n(78624),u=n(88486),f=n(91728),m=n(96156),h=n(34090),x=n(24246),y=function(e){var t=e.systems,n=e.dataFlows,r=e.onDataFlowSystemChange,i=(0,h.u6)().setFieldValue,a=n.map((function(e){return e.fides_key}));return(0,x.jsxs)(s.iA_,{size:"sm","data-testid":"assign-systems-delete-table",children:[(0,x.jsx)(s.hrZ,{children:(0,x.jsxs)(s.Tr,{children:[(0,x.jsx)(s.Th,{children:"System"}),(0,x.jsx)(s.Th,{})]})}),(0,x.jsx)(s.p3B,{children:t.filter((function(e){return a.includes(e.fides_key)})).map((function(e){return(0,x.jsxs)(s.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,x.jsx)(s.Td,{children:(0,x.jsx)(s.xvT,{fontSize:"xs",lineHeight:4,fontWeight:"medium",children:e.name})}),(0,x.jsx)(s.Td,{textAlign:"end",children:(0,x.jsx)(s.hU,{background:"gray.50","aria-label":"Unassign data flow from system",icon:(0,x.jsx)(m.l,{}),variant:"outline",size:"sm",onClick:function(){return function(e){var t=n.filter((function(t){return t.fides_key!==e.fides_key}));i("dataFlowSystems",t),r(t)}(e)},"data-testid":"unassign-btn"})})]},e.fides_key)}))})]})},g=n(44845),j=n(13861),p=n(73679),v=function(e){var t=e.allSystems,n=e.dataFlowSystems,r=e.onChange,i=e.flowType,a=(0,h.u6)().setFieldValue,o=function(e){if(!!n.find((function(t){return t.fides_key===e.fides_key}))){var t=n.filter((function(t){return t.fides_key!==e.fides_key}));a("dataFlowSystems",t),r(t)}else{var s=[].concat((0,p.Z)(n),[{fides_key:e.fides_key,type:"system"}]);a("dataFlowSystems",s),r(s)}};return(0,x.jsx)(s.xuv,{overflowY:"auto",maxHeight:"300px",children:(0,x.jsxs)(s.iA_,{size:"sm","data-testid":"assign-systems-table",maxHeight:"50vh",overflowY:"scroll",children:[(0,x.jsx)(s.hrZ,{position:"sticky",top:0,background:"white",zIndex:1,children:(0,x.jsxs)(s.Tr,{children:[(0,x.jsx)(s.Th,{children:"System"}),(0,x.jsxs)(s.Th,{textAlign:"right",children:["Set as ",i]})]})}),(0,x.jsx)(s.p3B,{children:t.map((function(e){var t=!!n.find((function(t){return t.fides_key===e.fides_key}));return(0,x.jsxs)(s.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,x.jsx)(s.Td,{children:(0,x.jsx)(s.xvT,{fontSize:"xs",lineHeight:4,fontWeight:"medium",children:e.name})}),(0,x.jsx)(s.Td,{textAlign:"right",children:(0,x.jsx)(s.rsf,{isChecked:t,onChange:function(){return o(e)},"data-testid":"assign-switch"})})]},e.fides_key)}))})]})})},C=function(e){var t=e.currentSystem,n=e.systems,i=e.isOpen,o=e.onClose,c=e.dataFlowSystems,l=e.onDataFlowSystemChange,u=e.flowType,f=(0,h.u6)().setFieldValue,m=(0,r.useState)(""),y=m[0],p=m[1],C=(0,r.useState)(c),w=C[0],k=C[1],b=function(){var e=(0,a.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l(w),o();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=0===n.length,_=(0,r.useMemo)((function(){return n?n.filter((function(e){return e.fides_key!==t.fides_key})).filter((function(e){return(0,j.R)(e,y)})):[]}),[n,t.fides_key,y]),T=(0,r.useMemo)((function(){var e=new Set(w.map((function(e){return e.fides_key})));return _.every((function(t){return e.has(t.fides_key)}))}),[_,w]);return(0,x.jsxs)(s.u_l,{isOpen:i,onClose:o,size:"2xl",isCentered:!0,children:[(0,x.jsx)(s.ZAr,{}),(0,x.jsxs)(s.hzk,{p:8,"data-testid":"confirmation-modal",children:[(0,x.jsxs)(s.xBx,{fontWeight:"medium",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,x.jsxs)(s.xvT,{fontSize:"2xl",lineHeight:8,fontWeight:"semibold",children:["Configure ",u.toLocaleLowerCase()," systems"]}),(0,x.jsxs)(s.Cts,{bg:"green.500",color:"white",px:1,children:["Assigned to ",w.length," systems"]})]}),(0,x.jsx)(s.fef,{"data-testid":"assign-systems-modal-body",children:S?(0,x.jsx)(s.xvT,{children:"No systems found"}):(0,x.jsxs)(s.Kqy,{spacing:4,children:[(0,x.jsxs)(s.kCb,{justifyContent:"space-between",children:[(0,x.jsx)(s.xvT,{fontSize:"sm",flexGrow:1,fontWeight:"medium",children:"Add or remove destination systems from your data map"}),(0,x.jsx)(s.xuv,{children:(0,x.jsxs)(s.NIc,{display:"flex",alignItems:"center",children:[(0,x.jsx)(s.lXp,{fontSize:"sm",htmlFor:"assign-all-systems",mb:"0",children:"Assign all systems"}),(0,x.jsx)(s.rsf,{size:"sm",id:"assign-all-systems",isChecked:T,onChange:function(e){if(e.target.checked&&n){var t=_.map((function(e){return{fides_key:e.fides_key,type:"system"}}));f("dataFlowSystems",t),k(t)}else k([])},"data-testid":"assign-all-systems-toggle"})]})})]}),(0,x.jsx)(g.Z,{search:y,onChange:p,placeholder:"Search for systems","data-testid":"system-search",withIcon:!0}),(0,x.jsx)(v,{flowType:u,allSystems:_,dataFlowSystems:w,onChange:k})]})}),(0,x.jsx)(s.mzw,{justifyContent:"flex-start",children:(0,x.jsxs)(s.hE2,{size:"sm",children:[(0,x.jsx)(s.zxk,{variant:"outline",mr:2,onClick:o,"data-testid":"cancel-btn",children:"Cancel"}),S?null:(0,x.jsx)(s.zxk,{colorScheme:"primary",onClick:b,"data-testid":"confirm-btn",children:"Confirm"})]})})]})]})},w=n(24753),k=n(6848),b=n(48466),S=n(51860);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O={dataFlowSystems:[]},F=function(e){var t=e.system,n=e.isIngress,i=e.isSystemTab,c=(0,s.pmc)(),m=n?"Source":"Destination",g="".concat(m,"s"),j=(0,s.qY0)(),p=(0,b.qQ)(),v=(0,o.Z)(p,1)[0];(0,b.K3)();var _=(0,k.C)(S.cS),F=(0,r.useMemo)((function(){var e=n?t.ingress:t.egress;e||(e=[]);var s=_?_.map((function(e){return e.fides_key})):[];return e.filter((function(e){return s.includes(e.fides_key)}))}),[n,t,_]),z=(0,r.useState)(F),D=z[0],L=z[1];(0,r.useEffect)((function(){L(F)}),[F]);var Z=function(){var e=(0,a.Z)(d().mark((function e(s,r){var i,a,o,u;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.dataFlowSystems,a=r.resetForm,o=T(T({},t),{},{ingress:n?i:t.ingress,egress:n?t.egress:i}),e.next=5,v(o);case 5:u=e.sent,(0,l.D4)(u)?c((0,w.Vo)("Failed to update data flows")):c((0,w.t5)("".concat(g," updated"))),a({values:{dataFlowSystems:i}});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return(0,x.jsxs)(s.Qdk,{children:[(0,x.jsx)(s.KFZ,{height:"68px",paddingLeft:i?6:2,"data-testid":"data-flow-button-".concat(m),children:(0,x.jsxs)(s.kCb,{alignItems:"center",justifyContent:"start",flex:1,textAlign:"left",children:[(0,x.jsx)(s.xvT,{fontSize:"sm",lineHeight:5,fontWeight:"semibold",mr:2,children:g}),(0,x.jsx)(s.Vp9,{ml:2,backgroundColor:"primary.400",borderRadius:"6px",color:"white",children:D.length}),(0,x.jsx)(s.LZC,{}),(0,x.jsx)(s.XEm,{})]})}),(0,x.jsx)(s.Hk3,{backgroundColor:"gray.50",padding:6,"data-testid":"data-flow-panel-".concat(m),children:(0,x.jsx)(s.Kqy,{borderRadius:"md",backgroundColor:"gray.50","aria-selected":"true",spacing:4,"data-testid":"selected",children:(0,x.jsx)(h.J9,{initialValues:O,onSubmit:Z,children:function(e){var n=e.isSubmitting,r=e.dirty,i=e.resetForm;return(0,x.jsxs)(h.l0,{children:[(0,x.jsx)(u.Gt,{id:"".concat(t.fides_key,":").concat(m),name:"".concat(m," Data Flow")}),(0,x.jsx)(s.zxk,{colorScheme:"primary",size:"xs",width:"fit-content",onClick:j.onOpen,"data-testid":"assign-systems-btn",rightIcon:(0,x.jsx)(f.A5,{}),marginBottom:4,children:"Configure ".concat(g.toLocaleLowerCase())}),(0,x.jsx)(y,{systems:_,dataFlows:D,onDataFlowSystemChange:L}),(0,x.jsxs)(s.hE2,{marginTop:6,children:[(0,x.jsx)(s.zxk,{size:"sm",variant:"outline",disabled:!r&&D===F,onClick:function(){L(F),i({values:{dataFlowSystems:F}})},children:"Cancel"}),(0,x.jsx)(s.zxk,{size:"sm",colorScheme:"primary",type:"submit",isLoading:n,disabled:!r&&D===F,"data-testid":"save-btn",children:"Save"})]}),j.isOpen?(0,x.jsx)(C,{currentSystem:t,systems:_,isOpen:j.isOpen,onClose:j.onClose,dataFlowSystems:D,onDataFlowSystemChange:L,flowType:m}):null]})}})})})]})},z=function(e){var t=e.system,n=e.isSystemTab;return(0,x.jsxs)(s.UQy,{allowToggle:!0,"data-testid":"data-flow-accordion",children:[(0,x.jsx)(F,{system:t,isIngress:!0,isSystemTab:n}),(0,x.jsx)(F,{system:t,isSystemTab:n})]})}},13861:function(e,t,n){"use strict";n.d(t,{R:function(){return _},Z:function(){return T}});var s=n(28841),r=n(27378),i=n(33571),a=n.n(i),o=n(24246),c=function(e){var t=e.columns,n=e.items,r=e.renderItem,i=(0,s.yo_)(n,t);return(0,o.jsx)(s.xuv,{children:i.map((function(e,n,i){var c=i.length;return(0,o.jsx)(s.xuv,{className:a()["grid-row"],borderBottomWidth:c>1&&n===c-1&&e.length===t?"0.5px":void 0,children:(0,o.jsx)(s.MIq,{columns:t,children:e.map((function(e){return(0,o.jsx)(s.xuv,{className:a()["grid-item"],children:r(e)},JSON.stringify(e))}))})},JSON.stringify(e))}))})},d=n(44845),l=n(55732),u=n(97865),f=n(34707),m=n.n(f),h=n(79894),x=n.n(h),y=n(86677),g=n(6848),j=n(2458),p=n(60709),v=n(63238),C=n(4938),w=n(78624),k=n(24753),b=n(51860),S=function(e){var t=e.system,n=(0,s.qY0)(),r=n.isOpen,i=n.onOpen,a=n.onClose,c=(0,s.pmc)(),d=(0,g.T)(),f=(0,y.useRouter)(),h=(0,b.DW)(),S=(0,u.Z)(h,1)[0],_=function(){var e=(0,l.Z)(m().mark((function e(){var n;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t.fides_key);case 2:n=e.sent,(0,w.D4)(n)?c((0,k.Vo)((0,w.e$)(n.error))):c((0,k.t5)("Successfully deleted system")),a();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=""===t.name||null==t.name?t.fides_key:t.name;return(0,o.jsxs)(s.xuv,{display:"flex","data-testid":"system-".concat(t.fides_key),children:[(0,o.jsx)(x(),{href:"".concat(p.So,"/configure/").concat(t.fides_key),passHref:!0,children:(0,o.jsxs)(s.xuv,{flexGrow:1,p:4,"data-testid":"system-box",_hover:{cursor:"pointer"},children:[(0,o.jsx)(s.X6q,{as:"h2",fontSize:"16px",mb:2,children:T}),(0,o.jsx)(s.xuv,{color:"gray.600",fontSize:"14px",children:(0,o.jsx)(s.xvT,{children:t.description})})]})}),(0,o.jsxs)(s.v2r,{children:[(0,o.jsx)(s.j2t,{as:s.hU,icon:(0,o.jsx)(s.nXP,{}),"aria-label":"more actions",variant:"unstyled",size:"sm","data-testid":"more-btn",m:1}),(0,o.jsxs)(s.qyq,{children:[(0,o.jsx)(s.sNh,{onClick:function(){d((0,b.db)(t)),f.push("".concat(p.So,"/configure/").concat(t.fides_key))},"data-testid":"edit-btn",children:"Edit"}),(0,o.jsx)(v.ZP,{scopes:[C.Sh.SYSTEM_DELETE],children:(0,o.jsx)(s.sNh,{onClick:i,"data-testid":"delete-btn",children:"Delete"})})]})]}),(0,o.jsx)(j.Z,{isOpen:r,onClose:a,onConfirm:_,title:"Delete ".concat(T),message:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(s.xvT,{children:["You are about to permanently delete the system"," ",(0,o.jsx)(s.xvT,{color:"complimentary.500",as:"span",fontWeight:"bold",children:T}),"."]}),(0,o.jsx)(s.xvT,{children:"Are you sure you would like to continue?"})]})})]})},_=function(e,t){var n,s;return(null===(n=e.name)||void 0===n?void 0:n.toLocaleLowerCase().includes(t.toLocaleLowerCase()))||(null===(s=e.description)||void 0===s?void 0:s.toLocaleLowerCase().includes(t.toLocaleLowerCase()))},T=function(e){var t=e.systems,n=(0,r.useState)(""),i=n[0],a=n[1],l=(0,r.useMemo)((function(){return t?t.filter((function(e){return _(e,i)})):[]}),[t,i]);return t&&t.length?(0,o.jsxs)(s.xuv,{"data-testid":"system-management",children:[(0,o.jsx)(s.xuv,{mb:4,"data-testid":"system-filters",children:(0,o.jsx)(d.Z,{search:i,onChange:a,maxWidth:"30vw",placeholder:"Search system name or description","data-testid":"system-search",withIcon:!0})}),(0,o.jsx)(c,{columns:3,items:l,renderItem:function(e){return(0,o.jsx)(S,{system:e})}})]}):(0,o.jsx)("div",{"data-testid":"empty-state",children:"No systems registered."})}},40397:function(e,t,n){"use strict";n.d(t,{f:function(){return c}});var s=n(6848),r=n(47134),i=n(75846),a=n(45128),o=n(75523),c=function(e){var t=e.includeDatasets,n=e.includeDisabled,c=(0,o.MO)().isLoading,d=(0,r.te)().isLoading,l=(0,i.fd)().isLoading,u=(0,a.LH)({onlyUnlinkedDatasets:!1},{skip:!t}).isLoading,f=(0,s.C)(o.qb),m=(0,s.C)(o.Bd),h=(0,s.C)(r.ZL),x=(0,s.C)(r.H7),y=(0,s.C)(i.U3),g=(0,s.C)(i.jp),j=(0,s.C)(a.Q4);return{allDataCategories:n?f:m,allDataSubjects:n?h:x,allDataUses:n?y:g,allDatasets:t?j:void 0,isLoading:c||d||l||u}}},33167:function(e,t,n){"use strict";n.d(t,{isAPIError:function(){return s.Bw},isErrorResult:function(){return s.D4}});var s=n(60041)},33571:function(e){e.exports={"grid-row":"BorderGrid_grid-row__gzSVf","grid-item":"BorderGrid_grid-item__7gUTW"}}}]);