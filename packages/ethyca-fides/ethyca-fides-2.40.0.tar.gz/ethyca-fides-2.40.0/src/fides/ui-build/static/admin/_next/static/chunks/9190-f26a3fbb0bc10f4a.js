"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9190],{86054:function(e,n,t){var i=t(90849),a=t(90089),r=t(28841),s=t(38687),o=t(24246),l=["title","tooltip","children"];function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}n.Z=function(e){var n=e.title,t=e.tooltip,i=e.children,c=(0,a.Z)(e,l);return(0,o.jsxs)(r.xuv,u(u({borderRadius:"md",border:"1px solid",borderColor:"gray.200"},c),{},{children:[(0,o.jsxs)(r.X6q,{as:"h3",fontSize:"sm",fontWeight:"semibold",color:"gray.700",py:4,px:6,backgroundColor:"gray.50",borderRadius:"md",textAlign:"left",children:[n,t?(0,o.jsx)(r.xvT,{as:"span",mx:1,children:(0,o.jsx)(s.Z,{label:t})}):void 0]}),(0,o.jsx)(r.Kqy,{p:6,spacing:6,children:i})]}))}},59190:function(e,n,t){t.d(n,{Z:function(){return Y}});var i=t(55732),a=t(97865),r=t(90849),s=t(34707),o=t.n(s),l=t(58981),c=t(28841),u=t(34090),d=t(86677),p=t(27378),f=t(6848),v=t(86054),g=t(43139),m=t(78624),h=t(60709),b=t(64429),j=t(38687),x=t(24753),y=t(75846),O=t(73679),_=t(49601),w=t(83026),P=t(89403),k=t(24246),C=function(e){var n=e.index;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(g.j0,{autoFocus:0!==n,name:"translations.".concat(n,".title"),label:"Title of privacy notice as displayed to user",variant:"stacked"}),(0,k.jsx)(g.Ks,{name:"translations.".concat(n,".description"),label:"Privacy notice displayed to the user",variant:"stacked"})]})},S=function(e){var n=e.index,t=e.name,i=e.isOOB;return(0,k.jsxs)(c.kCb,{direction:"column",gap:6,children:[(0,k.jsxs)(c.X6q,{size:"sm",children:["Edit ",t," translation"]}),i?(0,k.jsx)(w.f,{languageName:t}):null,(0,k.jsx)(C,{index:n})]})},D=function(e){var n=e.translation,t=e.name,i=e.onLanguageDeleted;return(0,k.jsxs)(c.kCb,{gap:2,direction:"row",w:"100%",children:[(0,k.jsx)(c.OK9,{as:c.zxk,variant:"outline",size:"sm",fontWeight:"normal",w:"100%",_selected:{color:"white",bg:"gray.500"},children:t},n.language),i?(0,k.jsx)(c.hU,{"aria-label":"Delete translation",variant:"outline",size:"sm",onClick:function(){return i(n.language)},children:(0,k.jsx)(c.pJl,{boxSize:4})}):null]})},E=function(e){var n,t=e.availableTranslations,i=(0,u.u6)(),a=i.values,r=i.setFieldValue,s=(0,p.useState)(!1),o=s[0],d=s[1],m=(0,p.useState)(!1),h=m[0],b=m[1],j=(0,p.useState)(0),x=j[0],y=j[1],w=(0,P.tB)({api_set:!1}).data,E=null===w||void 0===w||null===(n=w.plus_consent_settings)||void 0===n?void 0:n.enable_translations,N=(0,f.C)(_.Zp),Z=(0,f.C)(_.G1);(0,_.Ah)({page:N,size:Z});var T=(0,f.C)(_.fJ).slice().sort((function(e,n){return e.name.localeCompare(n.name)})),z=T.filter((function(e){var n;return null===(n=a.translations)||void 0===n?void 0:n.every((function(n){return n.language!==e.id}))})).map((function(e){return{label:e.name,value:e.id}})),R=function(e){var n=a.translations?a.translations.slice().filter((function(n){return n.language!==e})):[],t=x===n.length?n.length-1:x;r("translations",n),y(t)},q=function(e){var n,t;return null!==(n=null===(t=T.find((function(n){return n.id===e})))||void 0===t?void 0:t.name)&&void 0!==n?n:e};return E?(0,k.jsx)(v.Z,{title:"Localizations",children:(0,k.jsxs)(c.mQc,{index:x,onChange:function(e){y(e),b(!1)},as:c.Ugi,spacing:8,align:"start",grow:1,w:"100%",orientation:"vertical",variant:"unstyled",children:[(0,k.jsxs)(c.gCW,{spacing:4,minW:"30%",p:2,children:[(0,k.jsx)(c.tdY,{w:"100%",children:(0,k.jsx)(c.gCW,{spacing:2,w:"100%",p:4,maxH:60,overflow:"scroll",outline:"1px solid",outlineColor:"gray.200",borderRadius:"md",children:a.translations.map((function(e){return(0,k.jsx)(D,{translation:e,name:q(e.language),onLanguageDeleted:R},e.language)}))})}),o?(0,k.jsx)(c.xuv,{w:"full","data-testid":"select-language",children:(0,k.jsx)(l.Z,{chakraStyles:g.hP,size:"sm",options:z,onChange:function(e){return function(e){var n=null===t||void 0===t?void 0:t.find((function(n){return n.language===e}));b(!!n);var i=null!==n&&void 0!==n?n:{language:e,title:"",description:""};y(a.translations.length),r("translations",[].concat((0,O.Z)(a.translations),[i])),d(!1)}(e.value)},autoFocus:!0,classNamePrefix:"select-language",menuPlacement:"auto"})}):null,!o&&z.length?(0,k.jsx)(c.zxk,{leftIcon:(0,k.jsx)(c.jBn,{boxSize:6}),w:"full",variant:"outline",size:"sm",onClick:function(){return d(!0)},"data-testid":"add-language-btn",children:"Add a language"}):null]}),(0,k.jsx)(c.xuv,{w:"100%",children:(0,k.jsx)(u.F2,{name:"translations",render:function(){return(0,k.jsx)(c.nPR,{w:"100%",children:a.translations.map((function(e,n){return(0,k.jsx)(c.x45,{children:(0,k.jsx)(S,{index:n,name:q(e.language),isOOB:h})},e.language)}))})}})})]})}):(0,k.jsx)(v.Z,{title:"Notice text",children:(0,k.jsx)(C,{index:0})})},N=t(90089),Z=t(14633),T=t(1326),z=t(20800),R=t(4938),q=["privacy_notice_history_id"];function F(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function J(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?F(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var L=(0,T.Jt)(z.ye),A=(0,T.Jt)(z.B8),I=[{language:R.eU.EN,title:"",description:""}],B={name:"",consent_mechanism:R.J7.OPT_IN,data_uses:[],enforcement_level:R.QT.FRONTEND,disabled:!0,translations:I},M=Z.Ry().shape({name:Z.Z_().required().label("Title"),consent_mechanism:Z.Z_().required().label("Consent mechanism")}),W=t(14441),K=t.n(W),U=function(e){var n=e.isEditing,t=(0,u.u6)(),i=t.values,a=t.setFieldValue;return(0,p.useEffect)((function(){if(!n){var e=K()(i.name);a("notice_key",e)}}),[i.name,n,a]),(0,k.jsx)(g.j0,{name:"notice_key",label:"Key used in Fides cookie",variant:"stacked"})},V=t(15749);function Q(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function G(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Q(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Q(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var X=function(e){var n,t=e.regions,i=e.label,a=e.tooltip;return(0,k.jsxs)(c.gCW,{align:"start",children:[(0,k.jsxs)(c.kCb,{align:"start",children:[i?(0,k.jsx)(c.lXp,{htmlFor:"regions",fontSize:"xs",my:0,mr:1,children:i}):null,a?(0,k.jsx)(j.Z,{label:a}):null]}),(0,k.jsx)(c.xuv,{w:"100%","data-testid":"notice-locations",children:(0,k.jsx)(l.Z,{chakraStyles:G(G({},g.hP),{},{dropdownIndicator:function(e){return G(G({},e),{},{display:"none"})},multiValueRemove:function(e){return G(G({},e),{},{display:"none"})}}),classNamePrefix:"notice-locations",size:"sm",isMulti:!0,isDisabled:!0,placeholder:"No locations assigned",value:null!==(n=null===t||void 0===t?void 0:t.map((function(e){return{label:b.Z8[e],value:e}})))&&void 0!==n?n:[]})})]})},Y=function(e){var n=e.privacyNotice,t=e.availableTranslations,r=(0,d.useRouter)(),s=(0,c.pmc)(),l=n?function(e){var n,t,i,a;return{name:null!==(n=e.name)&&void 0!==n?n:B.name,consent_mechanism:null!==(t=e.consent_mechanism)&&void 0!==t?t:B.consent_mechanism,data_uses:null!==(i=e.data_uses)&&void 0!==i?i:B.data_uses,enforcement_level:null!==(a=e.enforcement_level)&&void 0!==a?a:B.enforcement_level,notice_key:e.notice_key,disabled:e.disabled,has_gpc_flag:e.has_gpc_flag,id:e.id,internal_description:e.internal_description,translations:e.translations?e.translations.map((function(e){var n;return e.privacy_notice_history_id,J(J({},(0,N.Z)(e,q)),{},{title:null!==(n=e.title)&&void 0!==n?n:""})})):I}}(n):B;(0,y.fd)();var b=(0,f.C)(y.qv),j=(0,V.vL)(),O=(0,a.Z)(j,1)[0],_=(0,V.p4)(),w=(0,a.Z)(_,1)[0],P=(0,p.useMemo)((function(){return!!n}),[n]),C=function(){var e=(0,i.Z)(o().mark((function e(t){var i,a,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!P){e.next=7;break}return l=G(G({},t),{},{id:n.id,translations:null!==(a=t.translations)&&void 0!==a?a:[]}),e.next=4,O(l);case 4:i=e.sent,e.next=10;break;case 7:return e.next=9,w(t);case 9:i=e.sent;case 10:(0,m.D4)(i)?s((0,x.Vo)((0,m.e$)(i.error))):(s((0,x.t5)("Privacy notice ".concat(P?"updated":"created"))),P||r.push(h.IT));case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,k.jsx)(u.J9,{initialValues:l,enableReinitialize:!0,onSubmit:C,validationSchema:M,children:function(e){var i=e.dirty,a=e.isValid,s=e.isSubmitting;return(0,k.jsx)(u.l0,{children:(0,k.jsxs)(c.Kqy,{spacing:10,children:[(0,k.jsxs)(c.Kqy,{spacing:6,children:[(0,k.jsxs)(v.Z,{title:"Privacy notice details",children:[(0,k.jsx)(g.j0,{label:"Notice title",name:"name",isRequired:!0,variant:"stacked"}),(0,k.jsx)(g.AP,{name:"consent_mechanism",label:"Consent mechanism",options:L,isRequired:!0,variant:"stacked"}),(0,k.jsx)(U,{isEditing:P}),(0,k.jsx)(X,{regions:null===n||void 0===n?void 0:n.configured_regions,label:"Locations where privacy notice is shown to visitors",tooltip:"To configure locations, change the privacy experiences where this notice is shown"}),(0,k.jsx)(g.w8,{name:"has_gpc_flag",label:"Configure whether this notice conforms to the Global Privacy Control",variant:"stacked"}),(0,k.jsx)(g.AP,{name:"data_uses",label:"Data use",options:b,isMulti:!0,variant:"stacked"}),(0,k.jsx)(g.AP,{name:"enforcement_level",label:"Enforcement level",options:A,isRequired:!0,variant:"stacked"})]}),(0,k.jsx)(E,{availableTranslations:t})]}),(0,k.jsxs)(c.hE2,{size:"sm",spacing:2,children:[(0,k.jsx)(c.zxk,{variant:"outline",onClick:function(){r.back()},children:"Cancel"}),(0,k.jsx)(c.zxk,{type:"submit",variant:"primary",size:"sm",isDisabled:s||!i||!a,isLoading:s,"data-testid":"save-btn",children:"Save"})]})]})})}})}},20800:function(e,n,t){t.d(n,{B8:function(){return r},Ep:function(){return s},ye:function(){return a}});var i=t(4938),a=new Map([[i.J7.OPT_IN,"Opt in"],[i.J7.NOTICE_ONLY,"Notice only"],[i.J7.OPT_OUT,"Opt out"]]),r=new Map([[i.QT.SYSTEM_WIDE,"System wide"],[i.QT.FRONTEND,"Front end"],[i.QT.NOT_APPLICABLE,"Not applicable"]]),s=new Map([["gpp_us_national","GPP US National"],["gpp_us_state","GPP US State"]])}}]);