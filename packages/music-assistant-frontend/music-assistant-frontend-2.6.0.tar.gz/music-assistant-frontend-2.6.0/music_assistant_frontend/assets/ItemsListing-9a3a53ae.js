import{av as x,aw as ve,l as ee,m as H,z as P,ax as Oe,v as dt,H as mt,f as g,D as ft,A as vt,ay as pt,r as V,E as z,d as te,c as n,e as v,u as h,a5 as G,b as ue,a6 as Le,az as K,w as d,g as I,i as j,t as b,X as A,j as p,_ as Q,M as R,aA as De,at as Te,ad as q,aB as yt,W as J,Y as ht,Q as bt,O as gt,a0 as wt,Z as kt,h as ce,a1 as St,a as _e,s as O,L as U,o as _t,T as Ie,as as It,aC as Ct,F as Ce,ao as $e}from"./index-9299e1c1.js";import{V as Me,M as Ne,f as Re,c as Z,s as $t}from"./VCheckbox-75b4c12a.js";import{_ as Bt}from"./eventbus-fb52ce0b.js";import{L as Vt}from"./ListItem-50af6ebb.js";import{B as Ee}from"./Button-784539f4.js";import{m as pe,b as ye,h as At,o as Ft,t as Pt,v as Ot,c as Lt,w as Y,A as Dt,V as Tt,C as Mt,D as W,s as de}from"./VListItem-748fc7af.js";import{d as Nt,b as Rt,c as me,f as Et}from"./VMenu-02b91385.js";import{_ as ae}from"./_plugin-vue_export-helper-c27b6911.js";import{V as jt,b as Kt}from"./VCard-6d87d169.js";import{V as Gt}from"./VSpacer-caa12be4.js";import{V as Yt,P as Xt}from"./PanelviewItemCompact-c5d1faef.js";import{V as zt}from"./VAlert-708f5408.js";import{C as Ut}from"./Container-ff473259.js";import{T as Ht}from"./Toolbar-eb89f7db.js";import{V as Wt}from"./VTextField-9151d790.js";import{V as qt}from"./VList-6d58de6a.js";import{a as Jt,V as Qt}from"./VInfiniteScroll-dfad6ac1.js";/* empty css              */import{V as Zt}from"./VVirtualScroll-1c00b40c.js";const je=(()=>x.reduce((l,a)=>(l[a]={type:[Boolean,String,Number],default:!1},l),{}))(),Ke=(()=>x.reduce((l,a)=>{const r="offset"+ve(a);return l[r]={type:[String,Number],default:null},l},{}))(),Ge=(()=>x.reduce((l,a)=>{const r="order"+ve(a);return l[r]={type:[String,Number],default:null},l},{}))(),Be={col:Object.keys(je),offset:Object.keys(Ke),order:Object.keys(Ge)};function xt(l,a,r){let u=l;if(!(r==null||r===!1)){if(a){const o=a.replace(l,"");u+=`-${o}`}return l==="col"&&(u="v-"+u),l==="col"&&(r===""||r===!0)||(u+=`-${r}`),u.toLowerCase()}}const ea=["auto","start","end","center","baseline","stretch"],ta=ee({cols:{type:[Boolean,String,Number],default:!1},...je,offset:{type:[String,Number],default:null},...Ke,order:{type:[String,Number],default:null},...Ge,alignSelf:{type:String,default:null,validator:l=>ea.includes(l)},...pe(),...ye()},"VCol"),Ve=H()({name:"VCol",props:ta(),setup(l,a){let{slots:r}=a;const u=P(()=>{const o=[];let m;for(m in Be)Be[m].forEach(S=>{const e=l[S],y=xt(m,S,e);y&&o.push(y)});const _=o.some(S=>S.startsWith("v-col-"));return o.push({"v-col":!_||!l.cols,[`v-col-${l.cols}`]:l.cols,[`offset-${l.offset}`]:l.offset,[`order-${l.order}`]:l.order,[`align-self-${l.alignSelf}`]:l.alignSelf}),o});return()=>{var o;return Oe(l.tag,{class:[u.value,l.class],style:l.style},(o=r.default)==null?void 0:o.call(r))}}}),he=["start","end","center"],Ye=["space-between","space-around","space-evenly"];function be(l,a){return x.reduce((r,u)=>{const o=l+ve(u);return r[o]=a(),r},{})}const aa=[...he,"baseline","stretch"],Xe=l=>aa.includes(l),ze=be("align",()=>({type:String,default:null,validator:Xe})),la=[...he,...Ye],Ue=l=>la.includes(l),He=be("justify",()=>({type:String,default:null,validator:Ue})),oa=[...he,...Ye,"stretch"],We=l=>oa.includes(l),qe=be("alignContent",()=>({type:String,default:null,validator:We})),Ae={align:Object.keys(ze),justify:Object.keys(He),alignContent:Object.keys(qe)},ia={align:"align",justify:"justify",alignContent:"align-content"};function sa(l,a,r){let u=ia[l];if(r!=null){if(a){const o=a.replace(l,"");u+=`-${o}`}return u+=`-${r}`,u.toLowerCase()}}const na=ee({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:Xe},...ze,justify:{type:String,default:null,validator:Ue},...He,alignContent:{type:String,default:null,validator:We},...qe,...pe(),...ye()},"VRow"),Fe=H()({name:"VRow",props:na(),setup(l,a){let{slots:r}=a;const u=P(()=>{const o=[];let m;for(m in Ae)Ae[m].forEach(_=>{const S=l[_],e=sa(m,_,S);e&&o.push(e)});return o.push({"v-row--no-gutters":l.noGutters,"v-row--dense":l.dense,[`align-${l.align}`]:l.align,[`justify-${l.justify}`]:l.justify,[`align-content-${l.alignContent}`]:l.alignContent}),o});return()=>{var o;return Oe(l.tag,{class:["v-row",u.value,l.class],style:l.style},(o=r.default)==null?void 0:o.call(r))}}});const Je=Symbol.for("vuetify:v-item-group"),ra=ee({...pe(),...At({selectedClass:"v-item--selected"}),...ye(),...dt()},"VItemGroup"),Qe=H()({name:"VItemGroup",props:ra(),emits:{"update:modelValue":l=>!0},setup(l,a){let{slots:r}=a;const{themeClasses:u}=mt(l),{isSelected:o,select:m,next:_,prev:S,selected:e}=Ft(l,Je);return()=>g(l.tag,{class:["v-item-group",u.value,l.class],style:l.style},{default:()=>{var y;return[(y=r.default)==null?void 0:y.call(r,{isSelected:o,select:m,next:_,prev:S,selected:e.value})]}})}}),E=H()({name:"VItem",props:Pt(),emits:{"group:selected":l=>!0},setup(l,a){let{slots:r}=a;const{isSelected:u,select:o,toggle:m,selectedClass:_,value:S,disabled:e}=Ot(l,Je);return()=>{var y;return(y=r.default)==null?void 0:y.call(r,{isSelected:u.value,selectedClass:_.value,select:o,toggle:m,value:S.value,disabled:e.value})}}});const ua=ee({id:String,text:String,...ft(Nt({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),fe=H()({name:"VTooltip",props:ua(),emits:{"update:modelValue":l=>!0},setup(l,a){let{slots:r}=a;const u=vt(l,"modelValue"),{scopeId:o}=Rt(),m=pt(),_=P(()=>l.id||`v-tooltip-${m}`),S=V(),e=P(()=>l.location.split(" ").length>1?l.location:l.location+" center"),y=P(()=>l.origin==="auto"||l.origin==="overlap"||l.origin.split(" ").length>1||l.location.split(" ").length>1?l.origin:l.origin+" center"),w=P(()=>l.transition?l.transition:u.value?"scale-transition":"fade-transition"),B=P(()=>z({"aria-describedby":_.value},l.activatorProps));return Lt(()=>{const D=me.filterProps(l);return g(me,z({ref:S,class:["v-tooltip",l.class],style:l.style,id:_.value},D,{modelValue:u.value,"onUpdate:modelValue":$=>u.value=$,transition:w.value,absolute:!0,location:e.value,origin:y.value,persistent:!0,role:"tooltip",activatorProps:B.value,_disableGlobalStack:!0},o),{activator:r.activator,default:function(){var L;for(var $=arguments.length,T=new Array($),F=0;F<$;F++)T[F]=arguments[F];return((L=r.default)==null?void 0:L.call(r,...T))??l.text}})}),Et({},S)}}),Ze=te({__name:"FavoriteButton",props:{item:{}},setup(l){const a=l;return(r,u)=>{var o;return n(),v(Ee,z(a,{variant:"list",icon:(o=r.item)!=null&&o.favorite?"mdi-heart":"mdi-heart-outline",title:r.$t("tooltip.favorite"),onClick:[u[0]||(u[0]=m=>h(ue).toggleFavorite(r.item)),u[1]||(u[1]=G(()=>{},["prevent"])),u[2]||(u[2]=G(()=>{},["stop"]))]}),null,16,["icon","title"])}}}),ca={key:0,class:"media-thumb listitem-media-thumb"},da={key:1,class:"media-thumb listitem-media-thumb"},ma={key:0},fa={key:1},va={key:0},pa={key:0,class:"line-clamp-1"},ya={key:1},ha={key:0},ba={key:1},ga={key:2},wa={key:3},ka={key:4},Sa={key:5},_a={key:2},Ia={key:3},Ca={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},$a=te({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean}},emits:["menu","click","select"],setup(l,{emit:a}){const{t:r}=Le(),u=l,o=P(()=>{if(!("provider_mappings"in u.item))return"";for(const e of u.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),m=a,_=function(e){const y="clientX"in e?e.clientX:e.touches[0].clientX,w="clientY"in e?e.clientY:e.touches[0].clientY;m("menu",u.item,y,w)},S=function(e){u.showCheckboxes||m("click",u.item,e.clientX,e.clientY)};return(e,y)=>(n(),v(Vt,{link:"",disabled:!h(Z)(e.item)||e.isDisabled,"show-menu-btn":e.showMenu,onClick:G(S,["stop"]),onMenu:G(_,["stop"])},{prepend:d(()=>[e.showCheckboxes?(n(),I("div",ca,[g(Me,{"model-value":e.isSelected,onClick:y[0]||(y[0]=G(()=>{},["stop"])),"onUpdate:modelValue":y[1]||(y[1]=w=>{w!=null&&m("select",e.item,w)})},null,8,["model-value"])])):(n(),I("div",da,[g(Ne,{size:"50",item:e.item},null,8,["item"])]))]),title:d(()=>[e.item.media_type==h(R).FOLDER?(n(),I("span",ma,[j("span",null,b(h(De)(e.item,h(r))),1)])):(n(),I("span",fa,[A(b(e.item.name)+" ",1),"version"in e.item&&e.item.version?(n(),I("span",va,"("+b(e.item.version)+")",1)):p("",!0)])),e.item&&e.item.metadata?(n(),v(h(fe),{key:2,location:"bottom"},{activator:d(({props:w})=>[h(Te)(e.item.metadata.explicit||!1)?(n(),v(Y,z({key:0},w,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):p("",!0)]),default:d(()=>[j("span",null,b(e.$t("tooltip.explicit")),1)]),_:1})):p("",!0)]),subtitle:d(()=>[e.item.media_type==h(R).TRACK&&"provider_mappings"in e.item?(n(),I("div",pa,[g(Qe,null,{default:d(()=>["artists"in e.item?(n(),v(E,{key:0},{default:d(()=>[A(b(h(q)(e.item.artists,2)),1)]),_:1})):p("",!0),e.showAlbum&&"album"in e.item&&e.item.album?(n(),v(E,{key:1},{default:d(()=>[A(" â€¢ "+b(e.item.album.name),1)]),_:1})):p("",!0),e.showDiscNumber&&"disc_number"in e.item&&e.item.disc_number?(n(),v(E,{key:2},{default:d(()=>[g(Y,{style:{"margin-left":"5px"},icon:"md:album"}),A(" "+b(e.item.disc_number),1)]),_:1})):p("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number?(n(),v(E,{key:3},{default:d(()=>[g(Y,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),A(" "+b(e.item.track_number),1)]),_:1})):e.showPosition&&"position"in e.item&&e.item.position?(n(),v(E,{key:4},{default:d(()=>[g(Y,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),A(" "+b(e.item.position),1)]),_:1})):p("",!0)]),_:1})])):e.item.media_type==h(R).ALBUM&&"year"in e.item?(n(),I("div",ya,[e.item.album_type!=h(yt).UNKNOWN?(n(),I("span",ha,b(e.$t("album_type."+e.item.album_type))+" â€¢ ",1)):p("",!0),j("span",null,b(h(q)(e.item.artists)),1),e.item.year?(n(),I("span",ba," â€¢ "+b(e.item.year),1)):p("",!0)])):"artists"in e.item&&e.item.artists?(n(),I("div",ga,b(h(q)(e.item.artists)),1)):"owner"in e.item&&e.item.owner?(n(),I("div",wa,b(e.item.owner),1)):e.item.media_type==h(R).RADIO&&e.item.metadata.description?(n(),I("div",ka,b(e.item.metadata.description),1)):"media_type"in e.item&&!e.item.provider_mappings?(n(),I("div",Sa,b(e.$t(e.item.media_type)),1)):p("",!0)]),append:d(()=>[o.value?(n(),v(Dt,{key:0,src:h(Re),width:"30",class:Q(e.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:d(()=>[g(h(fe),{activator:"parent",location:"bottom"},{default:d(()=>[A(b(o.value),1)]),_:1})]),_:1},8,["src","class"])):p("",!0),h(J)("bp2")&&e.showProvider?(n(),v(Bt,{key:1,domain:e.item.media_type==h(R).PLAYLIST?e.item.provider_mappings[0].provider_domain:e.item.provider,size:24},null,8,["domain"])):p("",!0),h(J)("bp3")&&"favorite"in e.item&&e.showFavorite&&!e.$vuetify.display.mobile?(n(),I("div",_a,[g(Ze,{item:e.item},null,8,["item"])])):p("",!0),e.showDuration&&e.item.media_type==h(R).TRACK&&"duration"in e.item&&e.item.duration!=null&&h(J)("bp0")?(n(),I("div",Ia,[j("div",null,[j("span",Ca,b(h(ht)(e.item.duration)),1)])])):p("",!0)]),_:1},8,["disabled","show-menu-btn"]))}});const Ba=ae($a,[["__scopeId","data-v-e9b09e11"]]),Va={key:0},Aa={key:1},Fa={key:2},Pa=["src"],Oa={key:0},La=te({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1}},emits:["menu","click","play","select"],setup(l,{emit:a}){const r=l,u=P(()=>{for(const e of r.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),o=a,m=function(e){if(r.showCheckboxes)return;const y="clientX"in e?e.clientX:e.touches[0].clientX,w="clientY"in e?e.clientY:e.touches[0].clientY;o("menu",r.item,y,w)},_=function(e){if(r.showCheckboxes){o("select",r.item,!r.isSelected);return}o("click",r.item,e.clientX,e.clientY)},S=function(e){r.showCheckboxes||o("play",r.item,e.clientX,e.clientY)};return(e,y)=>{const w=bt("hold");return n(),v(Yt,null,{default:d(({isHovering:B,props:D})=>[gt((n(),v(jt,z(D,{tile:"",hover:"",class:"panel-item",disabled:!h(Z)(e.item),onClick:_,onContextmenu:G(m,["right","prevent"])}),{default:d(()=>[e.showCheckboxes?(n(),v(me,{key:0,"model-value":e.showCheckboxes,contained:"",scrim:e.isSelected?e.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:d(()=>[g(Me,{class:"panel-item-checkbox",ripple:!1,"model-value":e.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):p("",!0),g(Ne,{item:e.item,style:{height:"auto"}},null,8,["item"]),g(Tt,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:d(()=>[g(Mt,null,{default:d(()=>[e.item.media_type==h(R).FOLDER?(n(),I("span",Va,[j("span",null,b(h(De)(e.item,e.$t)),1)])):(n(),I("span",Aa,b(e.item.name),1)),"version"in e.item&&e.item.version?(n(),I("span",Fa," - "+b(e.item.version),1)):p("",!0)]),_:1}),"artists"in e.item&&e.item.artists?(n(),v(W,{key:0,class:"line-clamp-1"},{default:d(()=>[A(b(h(q)(e.item.artists,1)),1)]),_:1})):"owner"in e.item&&e.item.owner?(n(),v(W,{key:1,class:"line-clamp-1"},{default:d(()=>[A(b(e.item.owner),1)]),_:1})):e.showMediaType?(n(),v(W,{key:2,class:"line-clamp-1"},{default:d(()=>[A(b(e.$t(e.item.media_type)),1)]),_:1})):(n(),v(W,{key:3,class:"line-clamp-1"}))]),_:1}),B||e.$vuetify.display.mobile?(n(),v(de,{key:1,icon:"mdi-play",color:"primary",fab:"",style:wt(`position: absolute; right: 15px; bottom: ${e.showActions?90:35}px; opacity: 0.8`),onClick:G(S,["stop"])},null,8,["style"])):p("",!0),e.showActions?(n(),v(Kt,{key:2,class:"panel-item-actions"},{default:d(()=>[g(Qe,{style:{padding:"0"}},{default:d(()=>[h(Te)(e.item.metadata.explicit||!1)?(n(),v(E,{key:0},{default:d(()=>[g(Y,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):p("",!0),u.value?(n(),v(E,{key:1},{default:d(()=>[g(Y,{class:Q(e.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:d(()=>[j("img",{src:h(Re),width:"30"},null,8,Pa),g(fe,{activator:"parent",location:"bottom"},{default:d(()=>[A(b(u.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):p("",!0),"track_number"in e.item&&e.item.track_number||"position"in e.item&&e.item.position?(n(),v(E,{key:2},{default:d(()=>[g(Y,{size:"small",icon:"mdi-music-circle-outline"}),e.item.disc_number?(n(),I("span",Oa,b(e.item.disc_number)+"/",1)):p("",!0),A(b(e.item.track_number||e.item.position),1)]),_:1})):p("",!0),h(J)("bp3")?(n(),v(E,{key:3},{default:d(()=>[g(Ze,{item:e.item},null,8,["item"])]),_:1})):p("",!0)]),_:1}),g(Gt),B||e.$vuetify.display.mobile?(n(),v(Ee,{key:0,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:y[0]||(y[0]=G($=>e.$emit("menu",e.item,$.clientX,$.clientY),["stop"]))})):p("",!0)]),_:2},1024)):p("",!0)]),_:2},1040,["disabled"])),[[w,m]])]),_:1})}}});const Da=ae(La,[["__scopeId","data-v-9508fb1a"]]),Ta={setup(l,a){const r=P(()=>({}));return{alertProps:P(()=>({...r.value,...a.attrs}))}}};function Ma(l,a,r,u,o,m){return n(),v(zt,z(u.alertProps,{class:"alert",color:"primary",density:"compact",prominent:""}),kt({_:2},[ce(l.$slots,(_,S)=>({name:S,fn:d(()=>[St(l.$slots,S)])}))]),1040)}const Pe=ae(Ta,[["render",Ma]]),Na={key:0},Ra={key:1},Ea=te({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(ue.providers).length>1},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1},noServerSideSorting:{type:Boolean,default:!1}},setup(l){const a=l,r=It(),{t:u}=Le(),o=V({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),m=V("list"),_=V(!1),S=V(!1),e=V([]),y=V([]),w=V(!1),B=V([]),D=V(!1),$=V(!1),T=V(!0),F=V(!1),L=V(!1),le=V(!1),xe=function(){_.value?_.value=!1:(_.value=!0,Ie(()=>{var t;(t=document.getElementById("searchInput"))==null||t.focus()}))},ge=function(){T.value=!T.value,localStorage.setItem(`expand.${a.path}.${a.itemtype}`,T.value.toString())},oe=function(t){m.value=t,localStorage.setItem(`viewMode.${a.path}.${a.itemtype}`,t)},et=function(){o.value.favoritesOnly=!o.value.favoritesOnly;const t=o.value.favoritesOnly?"true":"false";localStorage.setItem(`favoriteFilter.${a.path}.${a.itemtype}`,t),M(void 0,void 0,!0)},tt=function(){o.value.libraryOnly=!o.value.libraryOnly;const t=o.value.libraryOnly?"true":"false";localStorage.setItem(`libraryFilter.${a.path}.${a.itemtype}`,t),M(!0,void 0,!0)},at=function(){o.value.albumArtistsFilter=!o.value.albumArtistsFilter;const t=o.value.albumArtistsFilter?"true":"false";localStorage.setItem(`albumArtistsFilter.${a.path}.${a.itemtype}`,t),M(void 0,void 0,!0)},ie=function(t){return B.value.includes(t)},se=function(t,s){if(s)B.value.includes(t)||B.value.push(t);else for(let i=0;i<B.value.length;i++)B.value[i]===t&&B.value.splice(i,1)},lt=function(){$.value&&(B.value=[]),$.value=!$.value},ot=function(){M(!0,!0)},X=function(t,s,i){const k=Array.isArray(t)?t:[t];k[0].media_type!=R.FOLDER&&$t(k,a.parentItem,s,i)},ne=function(t,s,i){if(!Z(t)){X(t,s,i);return}t.media_type==R.FOLDER?r.push({name:"browse",query:{path:t.path}}):m.value=="list"&&t.media_type==R.TRACK&&a.parentItem?re(t,s,i):r.push({name:t.media_type,params:{itemId:t.item_id,provider:t.provider}})},re=function(t,s,i){if(!Z(t)){X(t,s,i);return}if(!O.activePlayerId){O.showPlayersMenu=!0;return}ue.playMedia(t.uri,void 0)},it=function(){o.value.search="",_.value=!1,M(void 0,void 0,!0)},st=function(t,s){t!==void 0&&(o.value.sortBy=t),localStorage.setItem(`sortBy.${a.path}.${a.itemtype}`,o.value.sortBy),M(void 0,void 0,!0)},nt=function(){O.globalSearchTerm=o.value.search,r.push({name:"search"})},rt=function({done:t}){if(F.value){t("empty");return}M(void 0,void 0,void 0,o.value.offset+a.limit).then(()=>{t("ok")})},we=P(()=>{var t=!1;return o.value.search&&o.value.search.length!==0&&(t=!0),t}),ut=P(()=>{var s,i;if(a.allowCollapse===!0&&!T.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:ge,overflowAllowed:!1}];const t=[];return a.showSelectButton!==!1&&t.push({label:"tooltip.select_items",icon:$.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:lt,active:$.value}),a.showLibraryOnlyFilter===!0&&t.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:tt,active:o.value.libraryOnly}),a.showFavoritesOnlyFilter===!0&&t.push({label:"tooltip.filter_favorites",icon:o.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:et,active:o.value.favoritesOnly}),a.showAlbumArtistsOnlyFilter===!0&&t.push({label:"tooltip.album_artist_filter",icon:o.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:at,active:o.value.albumArtistsFilter}),(a.showRefreshButton!==!1||D.value)&&t.push({label:D.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:ot,active:D.value,disabled:w.value}),(s=a.sortKeys)!=null&&s.length&&t.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:a.sortKeys.length<=1||w.value,subItems:a.sortKeys.map(k=>({label:`sort.${k}`,selected:o.value.sortBy==k,action:()=>{st(k)}}))}),a.showSearchButton!==!1&&t.push({label:we.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:xe,active:we.value,disabled:w.value}),t.push({label:"tooltip.toggle_view_mode",icon:m.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:m.value=="list",action:()=>{oe("list")}},{label:"view.panel",icon:"mdi-grid",selected:m.value=="panel",action:()=>{oe("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:m.value=="panel_compact",action:()=>{oe("panel_compact")}}]}),(i=a.extraMenuItems)!=null&&i.length&&t.push(...a.extraMenuItems),a.allowCollapse===!0&&t.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:ge}),t}),M=async function(t=!1,s=!1,i=!1,k=0){if(!w.value){if(w.value=!0,i&&a.loadPagedData!=null&&!a.noServerSideSorting&&(t=!0),(t||s)&&(k=0,F.value&&(le.value=!0),F.value=!1,L.value=!1,D.value=!1),o.value.offset=k,o.value.limit=a.limit,o.value.refresh=s,a.loadPagedData!=null&&a.noServerSideSorting){if(!L.value){e.value=[],y.value=[];let f=0;for(;!L.value;){const c=await a.loadPagedData({...o.value,offset:f});if(y.value.push(...c),f+=a.limit,Math.abs(c.length-a.limit)>10){L.value=!0;break}}}const C=Se(y.value,o.value);o.value.offset?e.value.push(...C):e.value=C,F.value=C.length<a.limit}else if(a.loadPagedData!=null){const C=await a.loadPagedData(o.value);o.value.offset?e.value.push(...C):e.value=C,Math.abs(C.length-a.limit)>10&&(F.value=!0)}else if(a.loadItems!=null){(!L.value||s)&&(y.value=await a.loadItems(o.value),L.value=!0);const C=Se(y.value,o.value);o.value.offset?e.value.push(...C):e.value=C,F.value=C.length<a.limit}o.value.refresh=!1,w.value=!1,le.value=!1}},ct=async function(){const t=`${a.path}.${a.itemtype}`,s=localStorage.getItem(`viewMode.${t}`);s&&s!=="null"?m.value=s:a.itemtype=="artists"||a.itemtype=="albums"?m.value="panel":m.value="list";const i=localStorage.getItem(`sortBy.${t}`);if(i&&i!=="null"&&a.sortKeys.includes(i)?o.value.sortBy=i:o.value.sortBy=a.sortKeys[0],a.showFavoritesOnlyFilter!==!1){const k=localStorage.getItem(`favoriteFilter.${t}`);k&&k=="true"&&(o.value.favoritesOnly=!0)}if(a.showLibraryOnlyFilter!==!1){const k=localStorage.getItem(`libraryFilter.${t}`);k&&k=="true"&&(o.value.libraryOnly=!0)}if(a.showAlbumArtistsOnlyFilter!==!1){const k=localStorage.getItem(`albumArtistsFilter.${t}`);k&&(o.value.albumArtistsFilter=k=="true")}if(a.allowCollapse!==!1){const k=localStorage.getItem(`expand.${t}`);k&&(T.value=k=="true")}if(a.restoreState){let k=`search.${t}`;a.parentItem&&(k+=a.parentItem.item_id);const C=localStorage.getItem(k);C&&C!=="null"&&(o.value.search=C)}},ke=function(t){O.dialogActive||w.value||(t.key==="a"&&(t.ctrlKey||t.metaKey)?(t.preventDefault(),B.value=e.value,$.value=!0):!S.value&&t.key=="Backspace"?o.value.search=o.value.search.slice(0,-1):!S.value&&t.key.length==1&&(o.value.search+=t.key,_.value=!0))};a.allowKeyHooks&&(document.addEventListener("keydown",ke),_e(()=>{document.removeEventListener("keydown",ke)})),a.restoreState&&_e(()=>{const t=a.path||a.itemtype,s=document.querySelector("#cont");O.prevState={path:t,scrollPos:(s==null?void 0:s.scrollTop)||0,pagedItems:e.value,allItems:y.value,allItemsReceived:F.value,initialDataReceived:L.value,params:o.value}}),U(()=>o.value.search,t=>{t&&(_.value=!0),M(void 0,void 0,!0);let s=`search.${a.path}.${a.itemtype}`;a.parentItem&&(s+=a.parentItem.item_id),localStorage.setItem(s,o.value.search)}),U(()=>a.path,t=>{w.value!=!0&&(e.value=[],y.value=[],M(!0))}),U(()=>a.parentItem,()=>{w.value!=!0&&(y.value=[],D.value=!0)},{deep:!0}),U(()=>a.limit,t=>{o.value.limit=t}),U(()=>a.updateAvailable,t=>{w.value||(D.value=t)},{immediate:!0}),_t(async()=>{var s;ct();const t=a.path||a.itemtype;a.restoreState&&((s=O.prevState)==null?void 0:s.path)==t?(o.value=O.prevState.params,e.value=O.prevState.pagedItems,y.value=O.prevState.allItems,F.value=O.prevState.allItemsReceived,L.value=O.prevState.initialDataReceived,Ie(()=>{const i=document.getElementById("cont");i&&Ct(i,O.prevState.scrollPos,50)}),w.value=!1):M(!0)});const N=function(t,s=!1){return t?"label"in t&&t.label&&t.name?u(t.label,[t.name]):"label"in t&&t.label?u(t.label):s&&"sort_name"in t&&t.sort_name?t.sort_name:t.name:""},Se=function(t,s){var k,C;let i=[];if(s.search){const f=s.search.toLowerCase();for(const c of t)(c.name.toLowerCase().includes(f)||"artist"in c&&((k=c.artist)!=null&&k.name.toLowerCase().includes(f))||"album"in c&&((C=c.album)!=null&&C.name.toLowerCase().includes(f))||"artists"in c&&c.artists&&c.artists.length&&c.artists[0].name.toLowerCase().includes(f))&&i.push(c)}else i=[...t];return s.sortBy=="name"&&i.sort((f,c)=>N(f).localeCompare(N(c),void 0,{numeric:!0})),s.sortBy=="sort_name"&&i.sort((f,c)=>N(f,!0).localeCompare(N(c,!0),void 0,{numeric:!0})),s.sortBy=="name_desc"&&i.sort((f,c)=>N(c).localeCompare(N(f),void 0,{numeric:!0})),s.sortBy=="album"&&i.sort((f,c)=>N(f.album).localeCompare(N(c.album),void 0,{numeric:!0})),s.sortBy=="artist"&&i.sort((f,c)=>N(f.artists[0]).localeCompare(N(c.artists[0]))),s.sortBy=="track_number"&&(i.sort((f,c)=>(f.track_number||0)-(c.track_number||0)),i.sort((f,c)=>(f.disc_number||0)-(c.disc_number||0))),s.sortBy=="position"&&i.sort((f,c)=>(f.position||0)-(c.position||0)),s.sortBy=="position_desc"&&i.sort((f,c)=>(c.position||0)-(f.position||0)),s.sortBy=="year"&&i.sort((f,c)=>(f.year||0)-(c.year||0)),s.sortBy=="recent"&&i.sort((f,c)=>(c.timestamp_added||0)-(f.timestamp_added||0)),s.sortBy=="duration"&&i.sort((f,c)=>(f.duration||0)-(c.duration||0)),s.sortBy=="duration_desc"&&i.sort((f,c)=>(c.duration||0)-(f.duration||0)),s.sortBy=="provider"&&i.sort((f,c)=>f.provider.localeCompare(c.provider)),s.favoritesOnly&&(i=i.filter(f=>f.favorite)),i.slice(s.offset,s.offset+s.limit)};return(t,s)=>t.hideOnEmpty&&e.value.length==0?p("",!0):(n(),I("section",Na,[g(Ht,{icon:t.icon,title:t.title,count:o.value.search?e.value.length:t.total||y.value.length,color:"transparent","menu-items":ut.value},null,8,["icon","title","count","menu-items"]),g(qt),_.value&&T.value?(n(),v(Wt,{key:0,id:"searchInput",modelValue:o.value.search,"onUpdate:modelValue":s[0]||(s[0]=i=>o.value.search=i),clearable:"","prepend-inner-icon":"mdi-magnify",label:t.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:s[1]||(s[1]=i=>S.value=!0),onBlur:s[2]||(s[2]=i=>S.value=!1),"onClick:clear":it},null,8,["modelValue","label"])):p("",!0),T.value?(n(),v(Ut,{key:1,variant:m.value=="list"?"default":"panel",style:{"overflow-x":"hidden"}},{default:d(()=>[le.value?p("",!0):(n(),v(Jt,{key:0,onLoad:rt,mode:t.infiniteScroll?"intersect":"manual","load-more-text":t.$t("load_more_items"),"empty-text":"",style:{"overflow-y":"hidden","overflow-x":"hidden"}},{default:d(()=>[m.value=="panel"?(n(),v(Fe,{key:0},{default:d(()=>[(n(!0),I(Ce,null,ce(e.value,i=>(n(),v(Ve,{key:i.uri,cols:"12",class:Q(`col-${h($e)(t.$vuetify.display.width)}`)},{default:d(()=>[g(Da,{item:i,"is-selected":ie(i),"show-checkboxes":$.value,"show-actions":["tracks","albums"].includes(t.itemtype),onSelect:se,onMenu:X,onClick:ne,onPlay:re},null,8,["item","is-selected","show-checkboxes","show-actions"])]),_:2},1032,["class"]))),128))]),_:1})):p("",!0),m.value=="panel_compact"?(n(),v(Fe,{key:1},{default:d(()=>[(n(!0),I(Ce,null,ce(e.value,i=>(n(),v(Ve,{key:i.uri,cols:"12",class:Q(`col-${h($e)(t.$vuetify.display.width)}`)},{default:d(()=>[g(Xt,{item:i,"is-selected":ie(i),"show-checkboxes":$.value,onSelect:se,onMenu:X,onClick:ne,onPlay:re},null,8,["item","is-selected","show-checkboxes"])]),_:2},1032,["class"]))),128))]),_:1})):p("",!0),m.value=="list"?(n(),v(Zt,{key:2,"item-height":70,height:"100%",items:e.value,style:{height:"100%"}},{default:d(({item:i})=>[g(Ba,{item:i,"show-track-number":t.showTrackNumber,"show-disc-number":t.showTrackNumber,"show-duration":t.showDuration,"show-favorite":t.showFavoritesOnlyFilter,"show-menu":t.showMenu,"show-provider":t.showProvider,"show-album":t.showAlbum,"show-checkboxes":$.value,"is-selected":ie(i),"show-details":t.itemtype.includes("versions"),onSelect:se,onMenu:X,onClick:ne},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","show-details"])]),_:1},8,["items"])):p("",!0)]),_:1},8,["mode","load-more-text"])),!w.value&&e.value.length==0?(n(),I("div",Ra,[!w.value&&e.value.length==0&&(o.value.search||o.value.favoritesOnly)?(n(),v(Pe,{key:0,title:t.$t("no_content_filter")},{default:d(()=>[o.value.search?(n(),v(de,{key:0,style:{"margin-top":"15px"},onClick:nt},{default:d(()=>[A(b(t.$t("try_global_search")),1)]),_:1})):p("",!0)]),_:1},8,["title"])):!w.value&&e.value.length==0?(n(),v(Pe,{key:1},{default:d(()=>[A(b(t.$t("no_content")),1)]),_:1})):p("",!0)])):p("",!0),g(Qt,{"model-value":B.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:d(()=>[g(de,{color:"primary",variant:"text",onClick:s[3]||(s[3]=i=>X(B.value,i.clientX,i.clientY))},{default:d(()=>[A(b(t.$t("actions")),1)]),_:1})]),default:d(()=>[j("span",null,b(t.$t("items_selected",[B.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):p("",!0)]))}});const il=ae(Ea,[["__scopeId","data-v-513c187a"]]);export{il as I,Fe as V,Ve as a,fe as b};
